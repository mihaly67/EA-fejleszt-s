
<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="x-dns-prefetch-control" content="on">

  <meta name="robots" content="max-snippet:250,max-image-preview:large">
  <meta name="description" content="In this article, we create a fully customizable session-based Opening Range Breakout (ORB) system in MQL5 that lets us set any desired session start time and range duration, automatically calculates the high and low of that opening period, and trades only confirmed breakouts in the direction of the move.">
  <meta property="og:url" content="https://www.mql5.com/en/articles/20339">
  <meta property="og:title" content="Automating Trading Strategies in MQL5 (Part 42): Session-Based Opening Range Breakout (ORB) System">
  <meta property="og:description" content="In this article, we create a fully customizable session-based Opening Range Breakout (ORB) system in MQL5 that lets us set any desired session start time and range duration, automatically calculates the high and low of that opening period, and trades only confirmed breakouts in the direction of the move.">
      <meta property="og:image" content="https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_1200x628.jpg">
      <meta property="og:image:secure_url" content="https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_1200x628.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2025-11-26T12:20:53.6884338Z">
  <meta property="article:author" content="https://www.mql5.com/en/users/29210372">
  <meta property="article:section" content="MetaTrader 5">
  <meta property="article:tag" content="Trading">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@mql5com">
  <meta name="twitter:image" content="https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_1200x628.jpg">
  <meta name="theme-color" content="#4a76b8">
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-config" content="none">
  <meta name="referrer" content="no-referrer-when-downgrade">
  <meta property="qc:admins" content="36367170677651456375">
  <meta property="wb:webmaster" content="073d7690269bcd81">
  <link rel="shortcut icon" href="https://c.mql5.com/i/favicon4.ico">
  <link rel="dns-prefetch" href="https://c.mql5.com">
  <link href="https://c.mql5.com/styles/core.fad34c848ba7d98f6c8f9fdc9c13736a.css" type="text/css" rel="stylesheet" media="all">
  <link href="https://c.mql5.com/styles/all.f5bbcd38b25f2cfbf68249d7ffdbfaba.css" type="text/css" rel="stylesheet" media="all">
  <link rel="preload" href="https://c.mql5.com/styles/chat.0e624e155e0815a7edf5d716c75e4c2a.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href="https://c.mql5.com/styles/chat.0e624e155e0815a7edf5d716c75e4c2a.css" type="text/css" rel="stylesheet" media="all"></noscript>
  <link href="https://c.mql5.com/styles/articles.5b583cbf5538b3c5ac59cacbc4446a1e.css" type="text/css" rel="stylesheet" media="all">
  <link href="/en/articles/rss" rel="alternate" type="application/rss+xml" title="Articles on the development and application of MetaTrader 5 trading robots and technical indicators">
  <link rel="canonical" href="https://www.mql5.com/en/articles/20339">
  <link rel="alternate" hreflang="en" href="https://www.mql5.com/en/articles/20339">
  <title>Automating Trading Strategies in MQL5 (Part 42): Session-Based Opening Range Breakout (ORB) System - MQL5 Articles</title>



<script type="text/javascript">
  !function(){window.mqGlobal={};var t=!1,n=!1,e=[],o=[],i=[];function d(t){var n;for(n=0;n<t.length;n+=1)t[n]()}function c(){t||(t=!0,d(e),d(o),o=[],e=[])}function a(){c(),n||(n=!0,d(i),i=[])}if(mqGlobal.AddOnReady=function(n,i){t?n(document):i?e.push(n):o.push(n)},mqGlobal.AddOnLoad=function(t){n?t(document):i.push(t)},mqGlobal.AddOnActiveWindowChange=function(t){this._onvisibility||(this._onvisibility=[]),this._onvisibility[this._onvisibility.length]=t},document.addEventListener)document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",a,!1);else if(document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){switch(document.readyState){case"interactive":c();break;case"complete":a()}})),window.attachEvent("onload",a),document.documentElement.doScroll&&window==window.top)){!function n(){if(!t&&document.body)try{document.documentElement.doScroll("left"),c()}catch(t){setTimeout(n,0)}}()}}();
  mqGlobal.CookieDomain = ".mql5.com";
  mqGlobal.Language = 'en';
  mqGlobal.IsMobile = false;
  mqGlobal.ClearRteStorage = function (e) { if (window.GStorage || (window.GStorage = globalStorage()), window.GStorage.supported) try { var o = e; window.GStorage.getItem("rte_autosave_uid", function (e, t) { t == o && (window.GStorage.removeItem("rte_autosave_text"), window.GStorage.removeItem("rte_autosave_date"), window.GStorage.removeItem("rte_autosave_uid")) }) } catch (e) { } };
</script>  <script type="text/javascript">
	mqGlobal.AddOnReady(function(){window.siteUpdates = new SiteUpdates('/en/updates',10,'en',[1,21],1764506229,0);});
	</script>

  

    <script src="https://c.mql5.com/js/all.794f844db8fe2cee0ccf9b292ed898e1.js" type="text/javascript" defer="defer"></script>
  <script src="https://c.mql5.com/js/vendor.b809b348045a1ca28cda0f89d01711db.js" type="text/javascript" defer="defer"></script>
  <script src="https://c.mql5.com/js/chat.17ac7de8ab325d93bdcdb78f6051fb90.js" type="text/javascript" defer="defer"></script>
  <script src="https://c.mql5.com/js/articles.0b0633eafc3082b19addeeea47a59af4.js" type="text/javascript" defer="defer"></script>


</head>

<body id="cover" class="cover">


  <nav class="head">
    <a href="https://www.mql5.com" class="head__logo" title="MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal"></a>
      <div class="head__content">
        <div class="main-menu" id="mainmenu">
          
                    <ul class="main-menu__top-level" id="menuTopLevel">
                    <li><a href="/en/forum" data-fz-event="MQL5+Menu+Forum">Forum</a></li>
                    <li><a href="/en/market" data-fz-event="MQL5+Menu+Market">Market</a></li>
                    <li><a href="/en/signals" data-fz-event="MQL5+Menu+Signals">Signals</a></li>
                    <li><a href="/en/job" data-fz-event="MQL5+Menu+Job">Freelance</a></li>
                    <li><a href="/en/vps" data-fz-event="MQL5+Menu+VPS">VPS</a></li>
                    <li><a href="/en/quotes/overview" data-fz-event="MQL5+Menu+Overview">Quotes</a></li>
                  </ul><ul class="main-menu__second-level" id="menuSecondLevel">
                    <li class="main-menu__selected"><a href="/en/articles" data-fz-event="MQL5+Menu+Articles"><img src="https://c.mql5.com/i/menu/icon-articles4.svg" alt="" width="16" height="16"/>Articles</a></li>
                    <li><a href="/en/code" data-fz-event="MQL5+Menu+CodeBase"><img src="https://c.mql5.com/i/menu/icon-code4.svg" alt="" width="16" height="16"/>CodeBase</a></li>
                    <li><a href="https://forge.mql5.io/?lang=en" target="_blank" rel="noopener" data-fz-event="MQL5+Menu+AlgoForge"><img src="https://c.mql5.com/i/menu/icon-algoforge4.svg" alt="" width="16" height="16"/>Algo Forge</a></li>
                    <li><a href="/en/docs" data-fz-event="MQL5+Menu+Docs"><img src="https://c.mql5.com/i/menu/icon-docs4.svg" alt="" width="16" height="16"/>Documentation</a></li>
                    <li><a href="/en/book" data-fz-event="MQL5+Menu+Book"><img src="https://c.mql5.com/i/menu/icon-book4.svg" alt="" width="16" height="16"/>AlgoBook</a></li>
                    <li><a href="/en/neurobook" data-fz-event="MQL5+Menu+Neurobook"><img src="https://c.mql5.com/i/menu/icon-neurobook4.svg" alt="" width="16" height="16"/>NeuroBook</a></li>
                    <li><a href="/en/economic-calendar" data-fz-event="MQL5+Menu+Economic+Calendar"><img src="https://c.mql5.com/i/menu/icon-economic-calendar4.svg" alt="" width="16" height="16"/>Calendar</a></li>
                    <li><a href="https://web.metatrader.app/terminal?mode=demo&lang=en" target="_blank" rel="nofollow noopener" data-fz-event="MQL5+Menu+Trading"><img src="https://c.mql5.com/i/menu/icon-trading4.svg" alt="" width="16" height="16"/>WebTerminal</a></li>
                    <li class="main-menu__mobile"><a href="/en/users/deszkmihaly67">Profile</a></li>
                    <li class="main-menu__mobile"><a href="/en/about">About</a></li>
                    <li class="main-menu__second-tools"><a rel="noopener" href="/en/vps" title="Reliable trader hosting for uninterrupted operation of robots and instant copying of trades" class="button-mt" data-vars-fz="Start+VPS+Trial+Submenu"><img width="18" height="18" src="https://c.mql5.com/i/sidebar/vpstrial2.svg" alt="" loading="lazy">Start VPS Trial</a></li>
                    </ul>
        </div>
          <div class="main-menu__active">
            <a id="mainMenuSelected" href="#">
              <span class="main-menu__primary">Articles</span><span class="main-menu__secondary">Sections</span>
            </a>
          </div>
<form action="https://www.mql5.com/en/search" onsubmit="return false;" autocomplete="off" id="headerSearchForm" class="header-search" method="post">
<button type="button" id="headerSearchButton" title="Search" class="header-search__button"></button><div class="header-search__input"><input name="keyword" type="text" enterkeyhint="search" title="Enter search text" placeholder="Search" id="headerSearchKeyword"/><label for="headerSearchKeyword" class="header-search__placeholder">Type <span>/</span> to search:  @user, $symbol, ...</label><button id="headerSearchSubmit" class="header-search__submit"></button></div><button type="button" id="headerSearchClean" title="Close" class="header-search__clean"></button></form>        <input class="blurHandler" id="mainMenuBlurHandler" type="checkbox">
      </div>
      <div class="head__toolbar" id="headerToolbar">
          <div class="container notifications-toolbar">
            <nav>
              <ul id="privateAreaMessages" class="notifications-box">
                <li class="notify-item notify-mobile"><a class="link-notify static link-notify_message-mobile" href="/en/users/deszkmihaly67/messages" id="notifyMessagesMobile" title="Messages"><i class="notify-icon notify-icon_messages"></i></a></li>
                <li class="notify-item notify-total">
                <ul class="notify-total__list" id="notifyTotalList">
<li class="notify-item notify-desktop"><a class="link-notify link-notify_message" href="/en/users/deszkmihaly67/messages" id="notifyMessages" title="Messages"><i class="notify-icon notify-icon_messages"></i></a></li>
<script type="application/json" id="dragAndDrop" data-type="translate">{
  "zoomIn": "zoom in",
  "zoomOut": "zoom out",
  "dragAndDrop": "Upload",
  "errorInvalidExtension": "Invalid extension",
  "invalidImageSize": "Invalid image size",
  "invalidImageType": "Invalid image format"
}</script>
<script type="application/json" id="lightBoxTranslates" data-type="translate">{
  "lightBox": {
    "collapse": "Collapse",
    "showOriginal": "Show original",
    "errorLoading": "Unable to download attachment",
    "next": "Next",
    "previous": "Previous",
    "linkToImg": "Link to the image",
    "linkToVideo": "Link to the video",
    "save": "Save",
    "close": "Close"
  }
}</script>
    
</ul></li>

              </ul>
            </nav>
          </div>
        <div class="toggle-button" id="sidebarToggleButton">
          <i></i>
        </div>

        <div class="group-menu" id="groupMenu">
            <div class="container profileToolbar">
              <nav>
                <ul id="profile" class="profile-box"><li class="userLinkContainer" id="userLinkContainer"><a href="/en/users/deszkmihaly67/news" class="userlink" id="userlink" title=""><img src="https://c.mql5.com/avatar/avatar_na2_micro.png" alt="" loading="lazy" width="29" height="29"><span class="firstname">Mih&#225;ly</span> <span class="lastname">Deszk</span></a><ul class="userLinkMenu user-link-menu" id="userLinkMenu" >
<li class="messages delimiter user-link-menu__item_with-counter user-link-menu__item"><a href="/en/users/deszkmihaly67/messages"><span>Messages</span><span class="user-link-menu__counter" id="counterMessagesMenu"></span></a></li>
<li class="news user-link-menu__item"><a href="/en/users/deszkmihaly67/news"><span>News feed</span></a></li>
<li class="profile user-link-menu__item_with-counter user-link-menu__item"><a href="/en/users/deszkmihaly67"><span>Profile</span><span title="Friend requests" class="user-link-menu__counter" id="counterOfferedFriendMenu"></span></a></li>
<li class="favorites user-link-menu__item"><a href="/en/users/deszkmihaly67/favorites"><span>Favorites</span></a></li>
<li class="topup delimiter user-link-menu__item"><a href="/en/users/deszkmihaly67/accounting/topup"><span>Top up MQL5 Services</span></a></li>
<li class="chooseout user-link-menu__item"><a href="/en/users/deszkmihaly67/accounting/chooseout"><span>Withdraw from account</span></a></li>
<li class="settings delimiter user-link-menu__item"><a href="/en/users/deszkmihaly67/edit"><span>Settings</span></a></li>
<li class="logout delimiter"><a href="/en/auth_logout" onclick="doPost(event,'/en/auth_logout','375c2c93715291f83bc74701b8b3a1e0'); return false;"><span>Logout</span></a></li>
</ul></li></ul>
              </nav>
            </div>


          <div class="container lang-menu-container">
            <div id="langMenuContainer" class="lang-menu">
              <input class="blurHandler" id="langmenuBlurHandler" type="checkbox">
              <nav>
                <ul class="lang-menu__list" id="langmenu">
                  <li class="lang-menu__list-item lang-menu__list-item_selected"><a href="/en/articles" aria-label="English (English)"><i class="icons-languages icons-languages_en"></i><span>English</span></a></li>
<li class="lang-menu__list-item"><a href="/ru/articles" aria-label="Русский (Russian)"><i class="icons-languages icons-languages_ru"></i><span>Русский</span></a></li>
<li class="lang-menu__list-item"><a href="/zh/articles" aria-label="中文 (Chinese)"><i class="icons-languages icons-languages_zh"></i><span>中文</span></a></li>
<li class="lang-menu__list-item"><a href="/es/articles" aria-label="Español (Spanish)"><i class="icons-languages icons-languages_es"></i><span>Español</span></a></li>
<li class="lang-menu__list-item"><a href="/pt/articles" aria-label="Português (Portuguese)"><i class="icons-languages icons-languages_pt"></i><span>Português</span></a></li>
<li class="lang-menu__list-item"><a href="/ja/articles" aria-label="日本語 (Japanese)"><i class="icons-languages icons-languages_ja"></i><span>日本語</span></a></li>
<li class="lang-menu__list-item"><a href="/de/articles" aria-label="Deutsch (German)"><i class="icons-languages icons-languages_de"></i><span>Deutsch</span></a></li>
<li class="lang-menu__list-item"><a href="/ko/articles" aria-label="한국어 (Korean)"><i class="icons-languages icons-languages_ko"></i><span>한국어</span></a></li>
<li class="lang-menu__list-item"><a href="/fr/articles" aria-label="Français (French)"><i class="icons-languages icons-languages_fr"></i><span>Français</span></a></li>
<li class="lang-menu__list-item"><a href="/it/articles" aria-label="Italiano (Italian)"><i class="icons-languages icons-languages_it"></i><span>Italiano</span></a></li>
<li class="lang-menu__list-item"><a href="/tr/articles" aria-label="Türkçe (Turkish)"><i class="icons-languages icons-languages_tr"></i><span>Türkçe</span></a></li>

                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
  </nav>

<div id='bfogggabsofabcpxuzmgaibarmaxasdrj' class="r4a1bvi22c6rx0xey g9z0qx14h"></div>

  <div id="left-sidebar-selector" class="left-sidebar__selector left-sidebar__selector_padding">
    <div class="left-sidebar__title">
MetaTrader 5 /     Trading
    </div>
    <i class="icons-ux icons-ux_arrow-down-black"></i>
  </div>
  <div class="articles-container block-with-sidebar">
    <aside class="left-sidebar left-sidebar_270" id="left-sidebar">
      
  <ul class="tree-menu-ul"><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/examples"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/examples.svg" alt="" loading="lazy"/>Examples</a><ul class="tree-menu__list tree-menu__list_nested"><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/examples_indicators"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/examples_indicators.svg" alt="" loading="lazy"/>Indicators</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/examples_experts"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/examples_experts.svg" alt="" loading="lazy"/>Experts</a></li></ul></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/strategy_tester"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/strategy_tester.svg" alt="" loading="lazy"/>Tester</a></li><li class="tree-menu__item tree-menu__item_selected"><a class="tree-menu__link" href="/en/articles/trading"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/trading.svg" alt="" loading="lazy"/>Trading</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/trading_systems"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/trading_systems.svg" alt="" loading="lazy"/>Trading systems</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/integration"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/integration.svg" alt="" loading="lazy"/>Integration</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/indicators"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/indicator.svg" alt="" loading="lazy"/>Indicators</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/expert_advisors"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/expert.svg" alt="" loading="lazy"/>Expert Advisors</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/statistics"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/statistics.svg" alt="" loading="lazy"/>Statistics and analysis</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/machine_learning"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/machine_learning.svg" alt="" loading="lazy"/>Machine learning</a></li><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/interviews"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/interviews.svg" alt="" loading="lazy"/>Interviews</a></li></ul><ul class="tree-menu-ul"><li class="tree-menu__item"><a class="tree-menu__link" href="/en/articles/my"><img class="tree-menu__icon" width="20" height="20" src="https://c.mql5.com/i/sidebar/articles.svg" alt="" loading="lazy"/>My own</a></li></ul>
  

    <div class="hints-panel">
      <div class="hints-panel__item">
        <i class="icons-hints icons-hints_like"></i>
        <div class="hints-panel__content">
          Do you like the article?<br>
          Share it with others —<br>post a <a href="https://www.mql5.com/en/articles/20339" target="_blank">link</a> to it!
        </div>
      </div>

      <div class="hints-panel__item">
        <i class="icons-hints icons-hints_fb-square icons-hints_24px"></i><div class="hints-panel__content">
Find us on <a href="https://www.facebook.com/mql5.community/" target="_blank" rel="nofollow">Facebook</a>!<br> Join our fan page</div>
      </div>

      <div class="hints-panel__item">
        <i class="icons-hints icons-hints_mt-5"></i>
        <div class="hints-panel__content">
          Use new possibilities of <a href="https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download" data-fz-event="MetaTrader+5+Desktop+Download+Article"  rel="nofollow">MetaTrader 5</a>
        </div>
      </div>
    </div>
<div id='vgckrufggwxdtfscpyalmenexmvhljduja' class="rnhyip6vynqcl5p06 g9z0qx14h"></div>      <div class="similar-author-articles ui">
        <h4 class="similar-author-articles__title">Similar articles</h4>
        <ul class="similar-author-articles__list">
            <li>
              <a href="/en/articles/20309" data-fz-event="MQL5+Article+Similar+Article">Developing a Trading Strategy: The Flower Volatility Index Trend-Following Approach</a>
            </li>
            <li>
              <a href="/en/articles/20327" data-fz-event="MQL5+Article+Similar+Article">Analytical Volume Profile Trading (AVPT): Liquidity Architecture, Market Memory, and Algorithmic Execution</a>
            </li>
            <li>
              <a href="/en/articles/20323" data-fz-event="MQL5+Article+Similar+Article">Automating Trading Strategies in MQL5 (Part 41): Candle Range Theory (CRT) – Accumulation, Manipulation, Distribution (AMD)</a>
            </li>
            <li>
              <a href="/en/articles/20287" data-fz-event="MQL5+Article+Similar+Article">Automating Black-Scholes Greeks: Advanced Scalping and Microstructure Trading</a>
            </li>
        </ul>
      </div>
    <div class="freelance-hint">
      <img src="https://c.mql5.com/i/articles/icon_freelance.svg" width="24" height="24" loading="lazy" />
      <div class="freelance-hint__text">
        Use the ideas from this article<br>to order your own robot<br>on Freelance
      </div>
        <a target="_blank" class="button button_blue-gray-border" title="Go to Freelance" href="/en/job/new" data-fz-event="MQL5+Article+New+Job">Go to Freelance</a>
    </div>

    </aside>
    <article class="content-with-sidebar articles-content splashed">
      


  <header class="article-header" style="background-color: rgb(233,229,217)">
    <section class="article-tools-panel">
        
      <div class="article-tools-panel__item">
        <a href="#pocket" title="Pocket allows you to insert a complete content description to the appropriate comment" onclick="return Pocket.Add(this,'en',2,1,20339);" class="article-tools-panel__rounded">
          <i class="article-pocket-icon"></i>
        </a>
      </div>
      <div class="article-tools-panel__item">
        <a href="/en/articles/20339?print=" target="_blank" class="article-tools-panel__rounded" rel="nofollow" title="Printer friendly version">
          <i class="article-print-icon"></i>
        </a>
      </div>

          <span class="article-tools-panel__button-area ui">
            <a class="button button_blue button_with-icon" href="/en/articles/new">
              <i class="icons-buttons icons-buttons_add-article"></i>Add a new article
            </a>
          </span>
    </section>
    <section class="article-header__image-box">
        <img class="article-header__image-preview" loading="lazy" width="32" height="16" alt="preview" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAsICAoIBwsKCQoNDAsNERwSEQ8PESIZGhQcKSQrKigkJyctMkA3LTA9MCcnOEw5PUNFSElIKzZPVU5GVEBHSEX/2wBDAQwNDREPESESEiFFLicuRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUX/wAARCAAQACADASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwIAB//EAB0QAQADAAEFAAAAAAAAAAAAAAEAAhEDEyExQYH/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAB/9oADAMBAAIRAxEAPwDp9udDG2w26jjD6YPZlVrntmbURgi6fYlLoeZTjNhFrCX/2Q==">
      <div class="article-header__gradient" style="background: linear-gradient(90deg, rgba(233,229,217, 1) 0%, rgba(233,229,217, 0.72) 8.31%, rgba(233,229,217, 0) 17.1%), linear-gradient(270deg, rgba(233,229,217, 1) 0%, rgba(233,229,217, 0.72) 8.06%, rgba(233,229,217, 0) 16.59%), linear-gradient(0deg, rgba(233,229,217, 1) 8.26%, rgba(233,229,217, 0.8) 65%, rgba(233,229,217, 0) 100%);"></div>
        <picture>
          <source srcset="https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_600x314.jpg, https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_1200x628.jpg 2x" media="(min-width:700px)">
          <img class="article-header__image" loading="lazy" width="600" height="314" srcset="https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_300x157.jpg, https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_600x314.jpg 2x" src="https://c.mql5.com/2/183/20339-automating-trading-strategies-in-mql5-part-42-session-based_600x314.jpg" alt="Automating Trading Strategies in MQL5 (Part 42): Session-Based Opening Range Breakout (ORB) System" onerror="this.style.display='none';">
        </picture>
    </section>
    <section class="article-header__content">
      <h1>Automating Trading Strategies in MQL5 (Part 42): Session-Based Opening Range Breakout (ORB) System</h1>
      <div class="article-header__info">
        <a href="/en/articles/mt5">MetaTrader 5</a>
          &mdash;
          <a href="/en/articles/mt5/trading">Trading</a>
        | <time datetime="2025-11-26T12:20Z" title="12:20" datetime-type="datetime">26 November 2025, 12:20</time>
      </div>
      <div class="article-header__indicators">
        <span title="Views">
          <img src="https://c.mql5.com/i/icons.svg#views-usage" width="20" height="20" alt="" />
          18 302
        </span>
        <span title="Comments">
          <img src="https://c.mql5.com/i/icons.svg#comments-usage" width="20" height="20" alt="" />
          3
        </span>
      </div>
      <div class="article-header__author">
          <div class="article-header__avatar">
            <img src="https://c.mql5.com/avatar/2022/11/637df59b-9551.jpg" srcset="https://c.mql5.com/avatar/2022/11/637df59b-9551_big.jpg 2x" data-user-login="29210372" title="Allan Munene Mutiiria" alt="Allan Munene Mutiiria" loading="lazy" width="60" height="60">
          </div>
<a class="author" href="/en/users/29210372" data-user-login="29210372">Allan Munene Mutiiria</a>      </div>
    </section>
  </header>

    <div class="content">
      <div class="inner">
        <h3 id="para1">Introduction</h3> <p>In our <a href="/en/articles/20323" target="_blank">previous article (Part 41)</a>, we developed a <a href="/go?link=https://innercircletrader.net/tutorials/candle-range-theory-crt/" title="https://innercircletrader.net/tutorials/candle-range-theory-crt/" rel="nofollow" target="_blank">Candle Range Theory (CRT)</a> trading system incorporating Accumulation, Manipulation, and Distribution (<a href="/go?link=https://innercircletrader.net/tutorials/ict-power-of-3/" title="https://innercircletrader.net/tutorials/ict-power-of-3/" rel="nofollow" target="_blank">AMD</a>) phases in <a href="https://www.metaquotes.net/en/metatrader5/algorithmic-trading/mql5" title="https://www.metaquotes.net/en/metatrader5/algorithmic-trading/mql5" target="_blank">MetaQuotes Language 5</a> (MQL5) that identified accumulation ranges on a specified timeframe, detected breaches with manipulation depth filtering, and confirmed reversals through bar closures for entry trades in the distribution phase. In Part 42, we develop a fully customizable Session-Based <a href="/go?link=https://www.fluxcharts.com/articles/trading-strategies/common-strategies/opening-range-breakout" title="https://www.fluxcharts.com/articles/trading-strategies/common-strategies/opening-range-breakout" rel="nofollow" target="_blank">Opening Range Breakout</a> (ORB) system.</p> <p>This system allows us to define the start time and duration of any session in minutes. It automatically captures the true high and low during that period on a chosen timeframe. It detects breakouts with optional multi-bar close confirmation to reduce false signals. The system executes trades only in the breakout direction. Stop-loss and take-profit levels can be dynamic (range-size based) or static. Trailing stops can be used after a profit threshold has been reached. Position limits are enforced per direction. We will cover the following topics:</p> <ol> <li><a href="/en/articles/20339#para2"> Understanding the Opening Range Breakout (ORB) Strategy</a></li> <li><a href="/en/articles/20339#para3"> Implementation in MQL5</a></li> <li><a href="/en/articles/20339#para4"> Backtesting</a></li> <li><a href="/en/articles/20339#para5"> Conclusion</a></li> </ol> <p></p> <p>By the end, you’ll have an MQL5 program capable of trading clean opening range breakouts in any market session — London, New York, Asian, or even custom openings — ready for further customization. Let’s dive in!</p> <p><br/></p> <h3 id="para2">Understanding the Opening Range Breakout (ORB) Strategy</h3> <p><a href="/en/articles/20339#para2">The </a><a href="/go?link=https://www.fluxcharts.com/articles/trading-strategies/common-strategies/opening-range-breakout" title="https://www.fluxcharts.com/articles/trading-strategies/common-strategies/opening-range-breakout" rel="nofollow" target="_blank">Opening Range Breakout (ORB)</a> is a classic intraday momentum strategy that capitalizes on the initial directional bias established at the start of a trading session. We define an "opening range" as the high and low formed during the first few minutes (typically 5–60 minutes) after the market opens, then wait for the price to break decisively above the range high (bullish breakout) or below the range low (bearish breakout) and enter in the direction of the break. The premise is simple but powerful: the opening range often represents the battle between buyers and sellers as the market digests overnight news and order flow, and a clean breakout signals that one side has won control, frequently leading to a sustained directional move. The system is generally easy. Have a look below at the different setups we could have.</p> <p style="text-align:center;"> <img width="684" height="373" src="https://c.mql5.com/2/181/Screenshot_2025-11-18_110512.png" loading="lazy" title="ORB STRATEGY SETUPS" alt="ORB STRATEGY SETUPS" style="vertical-align:middle;"/></p> <p>Our plan is to create a fully session-flexible ORB system that works on any instrument and any trading session (New York, London, Asian, or even custom openings).&nbsp; We will allow users to set the exact start time. For example, 09:30 for the NYSE or 08:00 for London. Users will also be able to define the range duration in minutes.&nbsp;The system will automatically calculate the true high and low on the selected timeframe within that window. If needed, users can enable multiple bar-close confirmations to validate a breakout. </p> <p>The algorithm will execute only one trade per direction per session. We will offer two types of stop-loss and take-profit calculations: dynamic (based on the range size) and static, with customizable risk-reward ratios.&nbsp;Points-based trailing stops will also be available, activating after a minimum profit threshold is reached. In addition, the tool will provide rich chart visualization. This includes filled range rectangles, vertical markers for session start and end, persistent high/low levels, and entry arrows.</p> <p>Visualization is equally important in our case, as you might have noticed by now, for clarity. In brief, here is a visual representation of our objectives.</p> <p style="text-align:center;"> <img width="700" height="505" src="https://c.mql5.com/2/181/Screenshot_2025-11-18_102142.png" loading="lazy" title="OBJECTIVES FRAMEWORK" alt="OBJECTIVES FRAMEWORK" style="vertical-align:middle;"/></p> <p><br/></p> <h3 id="para3">Implementation in MQL5</h3> <p>To create the program in MQL5, open the&nbsp;<a href="https://www.metatrader5.com/en/automated-trading/metaeditor" title="https://www.metatrader5.com/en/automated-trading/metaeditor" target="_blank">MetaEditor</a>, go to the Navigator, locate the Experts folder, click on the "New" tab, and follow the prompts to create the file. Once it is made, in the coding environment, we will need to declare some&nbsp;<a href="/en/docs/basis/variables/inputvariables" target="_blank">input parameters</a>&nbsp;and&nbsp;<a href="/en/docs/basis/variables/global" target="_blank">global variables</a>&nbsp;that we will use throughout the program.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORB Opening Range Breakout EA.mq5 |</span>
<span class="comment">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Copyright 2025, Allan Munene Mutiiria. |</span>
<span class="comment">//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://t.me/Forex_Algo_Trader |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="preprocessor">#property </span><span class="macro">copyright</span> <span class="string">"Copyright 2025, Allan Munene Mutiiria."</span>
<span class="preprocessor">#property </span><span class="macro">link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"https://t.me/Forex_Algo_Trader"</span>
<span class="preprocessor">#property </span><span class="macro">version</span>&nbsp;&nbsp; <span class="string">"1.00"</span>

<span class="preprocessor">#include </span>&lt;Trade\Trade.mqh&gt;

<span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Enums&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">enum</span> SLTP_Method {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Define SL/TP method enum</span>
&nbsp;&nbsp; Dynamic_Method = <span class="number">0</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Dynamic based on range size</span>
&nbsp;&nbsp; Static_Method&nbsp;&nbsp;= <span class="number">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Static based on fixed points</span>
};

<span class="keyword">enum</span> TrailingTypeEnum {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Define trailing type enum</span>
&nbsp;&nbsp; Trailing_None&nbsp;&nbsp; = <span class="number">0</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// None</span>
&nbsp;&nbsp; Trailing_Points = <span class="number">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// By Points</span>
};

<span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Input Parameters&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">input</span> <span class="macro">ENUM_TIMEFRAMES</span> RangeTF = <span class="macro">PERIOD_M5</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Timeframe for Opening Range Calculation</span>
<span class="keyword">input</span> <span class="keyword">int</span> RangeDurationMinutes = <span class="number">30</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Duration of Opening Range in Minutes</span>
<span class="keyword">input</span> <span class="keyword">string</span> SessionStartTime = <span class="string">"09:00"</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Session Start Time (HH:MM)</span>
<span class="keyword">input</span> <span class="keyword">double</span> TradeVolume = <span class="number">0.01</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Trade Volume Size</span>
<span class="keyword">input</span> <span class="keyword">double</span> RR_Ratio = <span class="number">2.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Risk to Reward Ratio</span>
<span class="keyword">input</span> SLTP_Method SLTP_Approach = Dynamic_Method;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// SL/TP Calculation Method</span>
<span class="keyword">input</span> <span class="keyword">int</span> SL_Points = <span class="number">50</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// SL Points (for Static Method)</span>
<span class="keyword">input</span> TrailingTypeEnum TrailingType = Trailing_None;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Trailing Stop Type</span>
<span class="keyword">input</span> <span class="keyword">double</span> Trailing_Stop_Points = <span class="number">20.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Trailing Stop in Points</span>
<span class="keyword">input</span> <span class="keyword">double</span> Min_Profit_To_Trail_Points = <span class="number">30.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Min Profit to Start Trailing in Points</span>
<span class="keyword">input</span> <span class="keyword">int</span> UniqueID = <span class="number">987654321</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Unique Trade Identifier</span>
<span class="keyword">input</span> <span class="keyword">int</span> MaxPositionsDir = <span class="number">1</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Max Positions per Direction</span>
<span class="keyword">input</span> <span class="keyword">bool</span> UseBreakoutFilter = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Use Breakout Confirmation Filter</span>
<span class="keyword">input</span> <span class="keyword">int</span> ConfirmBars = <span class="number">1</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Bars to Confirm Breakout on Close (0 to disable)</span><span>
</span></pre> <p>We begin the implementation by including the trade library with "<a href="/en/docs/basis/preprosessor/include" target="_blank">#include</a> &lt;Trade\Trade.mqh&gt;", which supplies the CTrade class and functions necessary for order execution and position management. We then define two <a href="/en/docs/basis/types/integer/enumeration" target="_blank">enumerations</a> to organize user options clearly. The "SLTP_Method" enum provides "Dynamic_Method" for stop-loss and take-profit levels based on the actual opening range size and "Static_Method" for fixed points-based calculations. Similarly, the "TrailingTypeEnum" enum offers "Trailing_None" to disable trailing and "Trailing_Points" to enable trailing by a user-defined number of points once a minimum profit threshold is reached.</p> <p>Next, we declare <a href="/en/docs/basis/variables/inputvariables" target="_blank">input parameters</a> that make the program highly configurable directly from the properties window. These include "RangeTF" to select the timeframe used for calculating the opening range high and low, "RangeDurationMinutes" to set how many minutes after session start constitute the opening range, "SessionStartTime" as a string in "HH:MM" format to define when each new session begins (e.g., "09:30" for NYSE open, "08:00" for London, etc.), "TradeVolume" for lot size, and the rest which are self explanatory. We added comments for clarity. This set of inputs ensures the system can be perfectly adapted to any market or session without code changes. The next thing we need is the <a href="/en/docs/basis/variables/global" target="_blank">global variables</a> definition.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Global Variables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
CTrade obj_Trade;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Trade object</span>
<span class="keyword">datetime</span> sessionStart = <span class="number">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Session start time</span>
<span class="keyword">datetime</span> rangeEndTime = <span class="number">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Range end time</span>
<span class="keyword">double</span> rangeHigh = <span class="number">0.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Range high</span>
<span class="keyword">double</span> rangeLow = <span class="number">0.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Range low</span>
<span class="keyword">bool</span> rangeDefined = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Range defined flag</span>
<span class="keyword">bool</span> breakoutHigh = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Breakout high flag</span>
<span class="keyword">bool</span> breakoutLow = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Breakout low flag</span>
<span class="keyword">double</span> breakoutPrice = <span class="number">0.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Breakout price</span>
<span class="keyword">string</span> highLevelObj = <span class="string">"ORB_HighLevel"</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- High level object name</span>
<span class="keyword">string</span> lowLevelObj = <span class="string">"ORB_LowLevel"</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Low level object name</span>
<span class="keyword">string</span> highTextObj = <span class="string">"ORB_High_Text"</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- High text object</span>
<span class="keyword">string</span> lowTextObj = <span class="string">"ORB_Low_Text"</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Low text object</span>
<span class="keyword">bool</span> tradedLong = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Traded long flag</span>
<span class="keyword">bool</span> tradedShort = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Traded short flag</span>
<span class="keyword">datetime</span> lastConfirmTime = <span class="number">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Last confirm time</span><span>
</span></pre> <p>We continue by declaring a set of <a href="/en/docs/basis/variables/global" target="_blank">global variables</a> that maintain the program's state throughout each trading session and ensure proper tracking of the opening range breakout logic. We instantiate "obj_Trade" from the <a href="/en/docs/standardlibrary/tradeclasses/ctrade" target="_blank">CTrade</a> class to handle all order executions and position modifications. Timing variables include "sessionStart" to record the exact datetime when a new session begins and "rangeEndTime" to mark when the opening range period concludes. We track the opening range boundaries with "rangeHigh" (initialized to 0.0) and "rangeLow", while "rangeDefined" serves as a boolean flag indicating whether the current session's range has been fully established. The rest are straightforward. Once that is done, we need to initialize the system by just setting the magic number.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| EA Start Function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">int</span> <span class="functions">OnInit</span>() {
&nbsp;&nbsp; obj_Trade.SetExpertMagicNumber(UniqueID);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set magic number</span>
&nbsp;&nbsp; <span class="keyword">return</span>(<span class="macro">INIT_SUCCEEDED</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Return success</span>
}<span>
</span></pre> <p>In the <a href="/en/docs/event_handlers/oninit" target="_blank">OnInit</a>&nbsp;event handler, which executes automatically when the program is first loaded or attached to a chart, we assign the user-defined "UniqueID" as the magic number to the "obj_Trade" object by calling "obj_Trade.SetExpertMagicNumber(UniqueID)". This ensures that every trade opened by the program carries this unique identifier, allowing precise filtering and management even when multiple programs or manual trades are active on the same account. We conclude by returning <a href="/en/docs/basis/function/events#enum_init_retcode" target="_blank">INIT_SUCCEEDED</a>, confirming to the platform that initialization completed without issues and the program is ready for operation. We will define some helper functions that we will use for visualization when we have the logic ready, as below.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Render Horizontal Level&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> RenderLevel(<span class="keyword">string</span> objName, <span class="keyword">double</span> levelVal, <span class="keyword">color</span> levelClr, <span class="keyword">string</span> levelDesc) {
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), objName);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete object</span>
&nbsp;&nbsp; <span class="functions">ObjectCreate</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJ_HLINE</span>, <span class="number">0</span>, <span class="number">0</span>, levelVal);&nbsp;&nbsp;  <span class="comment">//--- Create hline</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_COLOR</span>, levelClr);  <span class="comment">//--- Set color</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_STYLE</span>, <span class="macro">STYLE_DOT</span>); <span class="comment">//--- Set style</span>
&nbsp;&nbsp; <span class="functions">ObjectSetString</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_TOOLTIP</span>, levelDesc); <span class="comment">//--- Set tooltip</span>
&nbsp;&nbsp; <span class="functions">ChartRedraw</span>(<span class="functions">ChartID</span>());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Redraw chart</span>
}

<span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Render Vertical Line&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> RenderVLine(<span class="keyword">string</span> objName, <span class="keyword">datetime</span> timeVal, <span class="keyword">color</span> lineClr, <span class="keyword">string</span> desc) {
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), objName);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete object</span>
&nbsp;&nbsp; <span class="functions">ObjectCreate</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJ_VLINE</span>, <span class="number">0</span>, timeVal, <span class="number">0</span>);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Create vline</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_COLOR</span>, lineClr);&nbsp;&nbsp;<span class="comment">//--- Set color</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_STYLE</span>, <span class="macro">STYLE_DOT</span>); <span class="comment">//--- Set style</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_WIDTH</span>, <span class="number">1</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set width</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_BACK</span>, <span class="macro">true</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set back</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_RAY</span>, <span class="macro">true</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Set ray</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_HIDDEN</span>, <span class="macro">true</span>);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set hidden</span>
&nbsp;&nbsp; <span class="functions">ObjectSetString</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_TOOLTIP</span>, desc);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set tooltip</span>
&nbsp;&nbsp; <span class="functions">ChartRedraw</span>(<span class="functions">ChartID</span>());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Redraw chart</span>
}

<span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Render Text Label&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> RenderText(<span class="keyword">string</span> objName, <span class="keyword">datetime</span> timeVal, <span class="keyword">double</span> priceVal, <span class="keyword">string</span> textStr, <span class="keyword">color</span> textClr, <span class="keyword">int</span> anchorVal) {
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), objName);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete object</span>
&nbsp;&nbsp; <span class="functions">ObjectCreate</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJ_TEXT</span>, <span class="number">0</span>, timeVal, priceVal); <span class="comment">//--- Create text</span>
&nbsp;&nbsp; <span class="functions">ObjectSetString</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_TEXT</span>, textStr);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set text</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_COLOR</span>, textClr);&nbsp;&nbsp;<span class="comment">//--- Set color</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_ANCHOR</span>, anchorVal); <span class="comment">//--- Set anchor</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), objName, <span class="macro">OBJPROP_FONTSIZE</span>, <span class="number">10</span>);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set fontsize</span>
&nbsp;&nbsp; <span class="functions">ChartRedraw</span>(<span class="functions">ChartID</span>());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Redraw chart</span>
}

<span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Draw Entry Arrow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> DrawEntryArrow(<span class="keyword">datetime</span> timeVal, <span class="keyword">double</span> priceVal, <span class="keyword">bool</span> isBuy) {
&nbsp;&nbsp; <span class="keyword">string</span> markerName = <span class="string">"EntryMarker_"</span> + <span class="functions">IntegerToString</span>(timeVal); <span class="comment">//--- Marker name</span>
&nbsp;&nbsp; <span class="functions">ObjectCreate</span>(<span class="functions">ChartID</span>(), markerName, <span class="macro">OBJ_ARROW</span>, <span class="number">0</span>, timeVal, priceVal); <span class="comment">//--- Create arrow</span>
&nbsp;&nbsp; <span class="keyword">int</span> arrowCode = isBuy ? <span class="number">233</span> : <span class="number">234</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Arrow code</span>
&nbsp;&nbsp; <span class="keyword">color</span> arrowClr = isBuy ? <span class="macro">clrBlue</span> : <span class="macro">clrRed</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Arrow color</span>
&nbsp;&nbsp; <span class="keyword">int</span> anchor = isBuy ? <span class="macro">ANCHOR_BOTTOM</span> : <span class="macro">ANCHOR_TOP</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Anchor</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), markerName, <span class="macro">OBJPROP_ARROWCODE</span>, arrowCode); <span class="comment">//--- Set code</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), markerName, <span class="macro">OBJPROP_COLOR</span>, arrowClr); <span class="comment">//--- Set color</span>
&nbsp;&nbsp; <span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), markerName, <span class="macro">OBJPROP_ANCHOR</span>, anchor); <span class="comment">//--- Set anchor</span>
&nbsp;&nbsp; <span class="functions">ChartRedraw</span>(<span class="functions">ChartID</span>());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Redraw chart</span>
}

<span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Count Active Positions by Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">int</span> ActivePositions(<span class="macro">ENUM_POSITION_TYPE</span> posType) {
&nbsp;&nbsp; <span class="keyword">int</span> total = <span class="number">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Init total</span>
&nbsp;&nbsp; <span class="keyword">for</span> (<span class="keyword">int</span> pos = <span class="functions">PositionsTotal</span>() - <span class="number">1</span>; pos &gt;= <span class="number">0</span>; pos--) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Iterate positions</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (<span class="functions">PositionGetSymbol</span>(pos) == <span class="predefines">_Symbol</span> &amp;&amp; <span class="functions">PositionGetInteger</span>(<span class="macro">POSITION_MAGIC</span>) == UniqueID &amp;&amp; <span class="functions">PositionGetInteger</span>(<span class="macro">POSITION_TYPE</span>) == posType) { <span class="comment">//--- Check position</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Increment total</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp; }
&nbsp;&nbsp; <span class="keyword">return</span> total;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Return total</span>
}</pre> <p>Here, we create several helper functions to handle chart visualization and position management, ensuring the opening range and trade signals are clearly displayed while maintaining clean code organization. The "RenderLevel" function draws or updates persistent horizontal lines for the range high and low. It deletes any existing object with the given name, creates a new <a href="/en/docs/constants/objectconstants/enum_object/obj_hline" target="_blank">OBJ_HLINE</a>&nbsp;at the specified price level, sets its color (green for high, red for low), applies a dotted style, adds a descriptive tooltip, and redraws the chart for immediate visibility.</p> <p>Similarly, the "RenderVLine" function places vertical lines to mark session start and range end times. It removes prior instances, creates an <a href="/en/docs/constants/objectconstants/enum_object/obj_vline" target="_blank">OBJ_VLINE</a>&nbsp;at the given datetime, configures it with blue color, dotted style, width 1, background placement, rightward ray extension, hidden from object list, a tooltip showing the exact time, and triggers a chart redraw using the <a href="/en/docs/chart_operations/ChartRedraw" target="_blank">ChartRedraw</a>&nbsp;function. The "RenderText" function adds customizable text labels, such as start/end times or "ORB High"/"ORB Low" annotations. It clears existing text objects, creates an <a href="/en/docs/constants/objectconstants/enum_object/obj_text" target="_blank">OBJ_TEXT</a>&nbsp;at the specified time and price coordinates, sets the text content, and other properties.</p> <p>For trade entries, we implement "DrawEntryArrow," which places a visual marker directly on the chart at the moment of execution. It generates a unique name using the current time, creates an <a href="/en/docs/constants/objectconstants/enum_object/obj_arrow" target="_blank">OBJ_ARROW</a>, selects <a href="/en/docs/constants/objectconstants/wingdings" target="_blank">Wingdings</a> symbol 233 (up arrow) for buys or 234 (down arrow) for sells, applies blue for long or red for short, anchors it correctly at the bottom or top, and redraws the chart. For the arrow codes, MQL5 has dedicated fonts as below, and you can switch to whichever you like.</p> <p style="text-align:center;"> <img width="749" height="297" src="https://c.mql5.com/2/181/C_MQL5_WINGDINGS__1.png" loading="lazy" title="MQL5 WINGDINGS FONT CODES" alt="MQL5 WINGDINGS FONT CODES" style="vertical-align:middle;"/></p> <p>Finally, we define the "ActivePositions" function to safely count how many open positions exist for a specific type (buy or sell) that belong to this program. It loops backward through all positions, checks for a matching symbol, magic number via "UniqueID", and position type using <a href="/en/docs/constants/tradingconstants/positionproperties#enum_position_type" target="_blank">POSITION_TYPE_BUY</a>&nbsp;or "POSITION_TYPE_SELL", then returns the accurate count. With these, we can now begin the strategy implementation by first defining the ranges daily.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Tick Processing Function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> <span class="functions">OnTick</span>() {
&nbsp;&nbsp; <span class="keyword">datetime</span> currentTime = <span class="functions">TimeCurrent</span>();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get current time</span>
&nbsp;&nbsp; <span class="predefines">MqlDateTime</span> timeStruct;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Time structure</span>
&nbsp;&nbsp; <span class="functions">TimeToStruct</span>(currentTime, timeStruct);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Convert to struct</span>
&nbsp;&nbsp; <span class="comment">// Determine if a new session has started</span>
&nbsp;&nbsp; <span class="keyword">string</span> currentTimeStr = <span class="functions">StringFormat</span>(<span class="string">"%02d:%02d"</span>, timeStruct.hour, timeStruct.min); <span class="comment">//--- Format time string</span>
&nbsp;&nbsp; <span class="keyword">if</span> (currentTimeStr == SessionStartTime &amp;&amp; sessionStart != currentTime - (timeStruct.hour * <span class="number">3600</span> + timeStruct.min * <span class="number">60</span> + timeStruct.sec)) { <span class="comment">//--- Check new session</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionStart = currentTime - timeStruct.sec;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Align to minute start</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeEndTime = sessionStart + RangeDurationMinutes * <span class="number">60</span>;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Calc end time</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeHigh = <span class="number">0.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Reset high</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeLow = <span class="macro">DBL_MAX</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Reset low</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeDefined = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Reset defined</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;breakoutHigh = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Reset high breakout</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;breakoutLow = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Reset low breakout</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tradedLong = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Reset long traded</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tradedShort = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Reset short traded</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastConfirmTime = <span class="number">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Reset confirm time</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Clean previous visuals for current levels</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), highLevelObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete high level</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), lowLevelObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete low level</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), highTextObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete high text</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), lowTextObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete low text</span>
&nbsp;&nbsp; }
&nbsp;&nbsp; <span class="keyword">if</span> (sessionStart == <span class="number">0</span>) <span class="keyword">return</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Return if no session</span>
&nbsp;&nbsp; <span class="keyword">double</span> currBid = <span class="functions">SymbolInfoDouble</span>(<span class="predefines">_Symbol</span>, <span class="macro">SYMBOL_BID</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get bid</span>
&nbsp;&nbsp; <span class="keyword">double</span> currAsk = <span class="functions">SymbolInfoDouble</span>(<span class="predefines">_Symbol</span>, <span class="macro">SYMBOL_ASK</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get ask</span>
&nbsp;&nbsp; <span class="comment">// Define the opening range</span>
&nbsp;&nbsp; <span class="keyword">if</span> (currentTime &lt; rangeEndTime) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check within range</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeHigh = <span class="functions">MathMax</span>(rangeHigh, <span class="functions">iHigh</span>(<span class="predefines">_Symbol</span>, RangeTF, <span class="number">0</span>)); <span class="comment">//--- Update high</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeLow = <span class="functions">MathMin</span>(rangeLow, <span class="functions">iLow</span>(<span class="predefines">_Symbol</span>, RangeTF, <span class="number">0</span>));&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Update low</span>
&nbsp;&nbsp; } <span class="keyword">else</span> <span class="keyword">if</span> (!rangeDefined) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check not defined</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rangeDefined = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set defined</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Draw the opening range rectangle</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">string</span> rectObj = <span class="string">"ORB_Rectangle_"</span> + <span class="functions">IntegerToString</span>(sessionStart); <span class="comment">//--- Rect name</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectCreate</span>(<span class="functions">ChartID</span>(), rectObj, <span class="macro">OBJ_RECTANGLE</span>, <span class="number">0</span>, sessionStart, rangeHigh, rangeEndTime, rangeLow); <span class="comment">//--- Create rect</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), rectObj, <span class="macro">OBJPROP_COLOR</span>, <span class="macro">clrLightBlue</span>); <span class="comment">//--- Set color</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), rectObj, <span class="macro">OBJPROP_FILL</span>, <span class="macro">true</span>);&nbsp;&nbsp; <span class="comment">//--- Set fill</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), rectObj, <span class="macro">OBJPROP_BACK</span>, <span class="macro">true</span>);&nbsp;&nbsp; <span class="comment">//--- Set back</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ObjectSetInteger</span>(<span class="functions">ChartID</span>(), rectObj, <span class="macro">OBJPROP_STYLE</span>, <span class="macro">STYLE_SOLID</span>); <span class="comment">//--- Set style</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="functions">ChartRedraw</span>(<span class="functions">ChartID</span>());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Redraw chart</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Add vertical lines for start and end</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">string</span> startVLineObj = <span class="string">"ORB_StartVLine_"</span> + <span class="functions">IntegerToString</span>(sessionStart); <span class="comment">//--- Start vline name</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderVLine(startVLineObj, sessionStart, <span class="macro">clrBlue</span>, <span class="string">"ORB Start at "</span> + <span class="functions">TimeToString</span>(sessionStart, <span class="macro">TIME_MINUTES</span>)); <span class="comment">//--- Render start vline</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">string</span> endVLineObj = <span class="string">"ORB_EndVLine_"</span> + <span class="functions">IntegerToString</span>(sessionStart); <span class="comment">//--- End vline name</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderVLine(endVLineObj, rangeEndTime, <span class="macro">clrBlue</span>, <span class="string">"ORB End at "</span> + <span class="functions">TimeToString</span>(rangeEndTime, <span class="macro">TIME_MINUTES</span>)); <span class="comment">//--- Render end vline</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Add time text labels for start and end</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> textOffset = (rangeHigh - rangeLow) * <span class="number">0.05</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Calc offset</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">string</span> startTimeTextObj = <span class="string">"ORB_StartTime_Text_"</span> + <span class="functions">IntegerToString</span>(sessionStart); <span class="comment">//--- Start text name</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderText(startTimeTextObj, sessionStart, rangeLow - textOffset, <span class="functions">TimeToString</span>(sessionStart, <span class="macro">TIME_MINUTES</span>), <span class="macro">clrBlue</span>, <span class="macro">ANCHOR_UPPER</span>); <span class="comment">//--- Render start text</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">string</span> endTimeTextObj = <span class="string">"ORB_EndTime_Text_"</span> + <span class="functions">IntegerToString</span>(sessionStart); <span class="comment">//--- End text name</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderText(endTimeTextObj, rangeEndTime, rangeLow - textOffset, <span class="functions">TimeToString</span>(rangeEndTime, <span class="macro">TIME_MINUTES</span>), <span class="macro">clrBlue</span>, <span class="macro">ANCHOR_UPPER</span>); <span class="comment">//--- Render end text</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Render high and low levels</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderLevel(highLevelObj, rangeHigh, <span class="macro">clrGreen</span>, <span class="string">"ORB High"</span>); <span class="comment">//--- Render high level</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderLevel(lowLevelObj, rangeLow, <span class="macro">clrRed</span>, <span class="string">"ORB Low"</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Render low level</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Add text labels</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderText(highTextObj, rangeEndTime, rangeHigh, <span class="string">"ORB High"</span>, <span class="macro">clrGreen</span>, <span class="macro">ANCHOR_RIGHT_LOWER</span>); <span class="comment">//--- Render high text</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RenderText(lowTextObj, rangeEndTime, rangeLow, <span class="string">"ORB Low"</span>, <span class="macro">clrRed</span>, <span class="macro">ANCHOR_RIGHT_UPPER</span>); <span class="comment">//--- Render low text</span>
&nbsp;&nbsp; } 
}</pre> <p>In the <a href="/en/docs/event_handlers/ontick" target="_blank">OnTick</a>&nbsp;event handler, we begin by capturing the server's current time with <a href="/en/docs/dateandtime/timecurrent" target="_blank">TimeCurrent</a>&nbsp;into "currentTime", converting it to an <a href="/en/docs/constants/structures/mqldatetime" target="_blank">MqlDateTime</a>&nbsp;structure via <a href="/en/docs/dateandtime/timetostruct" target="_blank">TimeToStruct</a>&nbsp;to access individual components like hour and minute. We then format the current time as a "HH:MM" string using <a href="/en/docs/convert/stringformat" target="_blank">StringFormat</a>&nbsp;and store it in "currentTimeStr". This is how the structure looks.</p> <pre class="code"><span class="keyword">struct</span> <span class="predefines">MqlDateTime</span> {
&nbsp;&nbsp; <span class="keyword">int</span> year;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Year</span>
&nbsp;&nbsp; <span class="keyword">int</span> mon;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Month</span>
&nbsp;&nbsp; <span class="keyword">int</span> day;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Day</span>
&nbsp;&nbsp; <span class="keyword">int</span> hour;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">// Hour</span>
&nbsp;&nbsp; <span class="keyword">int</span> min;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Minutes</span>
&nbsp;&nbsp; <span class="keyword">int</span> sec;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Seconds</span>
&nbsp;&nbsp; <span class="keyword">int</span> day_of_week;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Day of week (0-Sunday, 1-Monday, ... ,6-Saturday)</span>
&nbsp;&nbsp; <span class="keyword">int</span> day_of_year;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Day number of the year (January 1st is assigned the number value of zero)</span>
};</pre> <p>Segregating into a structure helps us get the specific components with ease. To detect the exact start of a new trading session, we compare this string to the user-defined "SessionStartTime". The additional condition ensures we trigger only once per day by checking that "sessionStart" does not already match the current day aligned to that minute (subtracting seconds to normalize). When a new session begins, we align "sessionStart" precisely to the start of that minute by subtracting remaining seconds, calculate "rangeEndTime" by adding "RangeDurationMinutes" × 60 seconds, reset "rangeHigh" to 0.0 and "rangeLow" to the maximum double value for proper initial updates, clear all flags ("rangeDefined", "breakoutHigh", "breakoutLow", "tradedLong", "tradedShort", "lastConfirmTime"), and delete the persistent high/low level and text objects from the previous session to prepare a clean slate. If no active session has been detected yet ("sessionStart" == 0), we simply return to avoid unnecessary processing. Otherwise, we retrieve the current bid and ask prices using the <a href="/en/docs/marketinformation/symbolinfodouble" target="_blank">SymbolInfoDouble</a>&nbsp;function.</p> <p>During the opening range formation period (while "currentTime" &lt; "rangeEndTime"), we continuously update the range boundaries by setting "rangeHigh" to the maximum of its current value or the latest bar's high on "RangeTF" at shift 0 via "iHigh", and "rangeLow" to the minimum of its current value or the latest bar's low via the <a href="/en/docs/series/ilow" target="_blank">iLow</a>&nbsp;function. Once the range period ends and the range hasn't been finalized yet ("!rangeDefined"), we set "rangeDefined" to true and proceed to visualize the completed opening range.</p> <p>We draw a filled light-blue rectangle spanning from "sessionStart" at "rangeHigh" to "rangeEndTime" at "rangeLow" using a unique name based on the session timestamp, with solid style and background placement. Vertical blue dotted lines are added at both start and end times via "RenderVLine" with descriptive tooltips. Time labels are placed just below the range using "RenderText" with a small offset calculated as 5% of the range size, anchored upward in blue. Finally, we render the persistent horizontal levels with "RenderLevel" (green for high, red for low) and their corresponding text labels anchored at the right side of the range end time, ensuring we always see the exact breakout levels even hours or days later. Upon compilation, we get the following outcome.</p> <p style="text-align:center;"> <img width="700" height="505" src="https://c.mql5.com/2/181/Screenshot_2025-11-18_110930.png" loading="lazy" title="ORB RANGES ESTABLISHMENT" alt="ORB RANGES ESTABLISHMENT" style="vertical-align:middle;"/></p> <p>With the ranges established, we just need to track them and their breakouts, and once we break from either range, we determine the direction and thus the type of breakout setup and open trades. Easy peasy. Here is the logic we use to achieve that.</p> <pre class="code"><span class="keyword">if</span> (!rangeDefined) <span class="keyword">return</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Return if not defined</span>
<span class="comment">// Detect breakout</span>
<span class="keyword">bool</span> justBreached = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Init just breached</span>
<span class="keyword">if</span> (currAsk &gt; rangeHigh &amp;&amp; !breakoutHigh) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check high breakout</span>
&nbsp;&nbsp; breakoutHigh = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set high breakout</span>
&nbsp;&nbsp; justBreached = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set just breached</span>
&nbsp;&nbsp; breakoutPrice = currAsk;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set breakout price</span>
} <span class="keyword">else</span> <span class="keyword">if</span> (currBid &lt; rangeLow &amp;&amp; !breakoutLow) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Check low breakout</span>
&nbsp;&nbsp; breakoutLow = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Set low breakout</span>
&nbsp;&nbsp; justBreached = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set just breached</span>
&nbsp;&nbsp; breakoutPrice = currBid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set breakout price</span>
}
<span class="keyword">if</span> ((breakoutHigh || breakoutLow) &amp;&amp; !(tradedLong || tradedShort)) { <span class="comment">//--- Check breakout and not traded</span>
&nbsp;&nbsp; <span class="comment">// Confirm breakout with bar closures if enabled</span>
&nbsp;&nbsp; <span class="keyword">bool</span> confirmed = <span class="macro">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Init confirmed</span>
&nbsp;&nbsp; <span class="keyword">if</span> (ConfirmBars == <span class="number">0</span>) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check no confirm</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;confirmed = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Set confirmed</span>
&nbsp;&nbsp; } <span class="keyword">else</span> {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Else</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">datetime</span> currConfirmTime = <span class="functions">iTime</span>(<span class="predefines">_Symbol</span>, RangeTF, <span class="number">0</span>);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get confirm time</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (currConfirmTime != lastConfirmTime) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Check new confirm</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lastConfirmTime = currConfirmTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Update last confirm</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">int</span> confirmCount = <span class="number">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Init count</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ConfirmBars; i++) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Iterate bars</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> closePrice = <span class="functions">iClose</span>(<span class="predefines">_Symbol</span>, RangeTF, i);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get close</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (breakoutHigh &amp;&amp; closePrice &gt; rangeHigh) confirmCount++; <span class="comment">//--- Check high</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (breakoutLow &amp;&amp; closePrice &lt; rangeLow) confirmCount++; <span class="comment">//--- Check low</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (confirmCount &gt;= ConfirmBars) confirmed = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Set confirmed</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp; }
&nbsp;&nbsp; <span class="keyword">if</span> (confirmed &amp;&amp; UseBreakoutFilter) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check confirmed and filter</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Additional filter logic if needed, but for now assume confirmed</span>
&nbsp;&nbsp; }
&nbsp;&nbsp; <span class="keyword">if</span> (confirmed) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Check confirmed</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> sl = <span class="number">0.0</span>, tp = <span class="number">0.0</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Init SL TP</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (breakoutHigh &amp;&amp; ActivePositions(<span class="macro">POSITION_TYPE_BUY</span>) &lt; MaxPositionsDir &amp;&amp; !tradedLong) { <span class="comment">//--- Check long entry</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (SLTP_Approach == Dynamic_Method) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check dynamic</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> rangeSize = rangeHigh - rangeLow;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Calc range size</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sl = <span class="functions">NormalizeDouble</span>(rangeLow, <span class="predefines">_Digits</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Set SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp = <span class="functions">NormalizeDouble</span>(currAsk + rangeSize * RR_Ratio, <span class="predefines">_Digits</span>); <span class="comment">//--- Set TP</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <span class="keyword">else</span> {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Static</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sl = <span class="functions">NormalizeDouble</span>(currAsk - SL_Points * <span class="predefines">_Point</span>, <span class="predefines">_Digits</span>); <span class="comment">//--- Set SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp = <span class="functions">NormalizeDouble</span>(currAsk + (SL_Points * <span class="predefines">_Point</span>) * RR_Ratio, <span class="predefines">_Digits</span>); <span class="comment">//--- Set TP</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (obj_Trade.Buy(TradeVolume, <span class="predefines">_Symbol</span>, currAsk, sl, tp, <span class="string">"ORB Long Breakout"</span>)) { <span class="comment">//--- Open buy</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (obj_Trade.ResultRetcode() == <span class="macro">TRADE_RETCODE_DONE</span>) { <span class="comment">//--- Check success</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="functions">Print</span>(<span class="string">"Long Breakout: Entry at "</span>, <span class="functions">DoubleToString</span>(currAsk, <span class="predefines">_Digits</span>), <span class="string">" SL at "</span>, <span class="functions">DoubleToString</span>(sl, <span class="predefines">_Digits</span>), <span class="string">" TP at "</span>, <span class="functions">DoubleToString</span>(tp, <span class="predefines">_Digits</span>)); <span class="comment">//--- Log entry</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DrawEntryArrow(currentTime, currBid, <span class="macro">true</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Draw arrow</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tradedLong = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Set long traded</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <span class="keyword">else</span> <span class="keyword">if</span> (breakoutLow &amp;&amp; ActivePositions(<span class="macro">POSITION_TYPE_SELL</span>) &lt; MaxPositionsDir &amp;&amp; !tradedShort) { <span class="comment">//--- Check short entry</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (SLTP_Approach == Dynamic_Method) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Check dynamic</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> rangeSize = rangeHigh - rangeLow;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Calc range size</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sl = <span class="functions">NormalizeDouble</span>(rangeHigh, <span class="predefines">_Digits</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp = <span class="functions">NormalizeDouble</span>(currBid - rangeSize * RR_Ratio, <span class="predefines">_Digits</span>); <span class="comment">//--- Set TP</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <span class="keyword">else</span> {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Static</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sl = <span class="functions">NormalizeDouble</span>(currBid + SL_Points * <span class="predefines">_Point</span>, <span class="predefines">_Digits</span>); <span class="comment">//--- Set SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tp = <span class="functions">NormalizeDouble</span>(currBid - (SL_Points * <span class="predefines">_Point</span>) * RR_Ratio, <span class="predefines">_Digits</span>); <span class="comment">//--- Set TP</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (obj_Trade.Sell(TradeVolume, <span class="predefines">_Symbol</span>, currBid, sl, tp, <span class="string">"ORB Short Breakout"</span>)) { <span class="comment">//--- Open sell</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (obj_Trade.ResultRetcode() == <span class="macro">TRADE_RETCODE_DONE</span>) { <span class="comment">//--- Check success</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="functions">Print</span>(<span class="string">"Short Breakout: Entry at "</span>, <span class="functions">DoubleToString</span>(currBid, <span class="predefines">_Digits</span>), <span class="string">" SL at "</span>, <span class="functions">DoubleToString</span>(sl, <span class="predefines">_Digits</span>), <span class="string">" TP at "</span>, <span class="functions">DoubleToString</span>(tp, <span class="predefines">_Digits</span>)); <span class="comment">//--- Log entry</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DrawEntryArrow(currentTime, currAsk, <span class="macro">false</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Draw arrow</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tradedShort = <span class="macro">true</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Set short traded</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp; }
}</pre> <p>Once the opening range is fully defined, we immediately return if "rangeDefined" is still false, ensuring no breakout logic runs prematurely. We then monitor for a breakout: if the current ask price exceeds "rangeHigh" and "breakoutHigh" is not yet set, we mark a bullish breakout by setting "breakoutHigh" to true, record the exact breakout price in "breakoutPrice", and note that a fresh breach has occurred. We do the same thing for low breakout. When at least one breakout direction is active and neither a long nor short trade has been taken in this session ("!tradedLong &amp;&amp; !tradedShort"), we proceed to the confirmation stage. If "ConfirmBars" is zero, the breakout is considered instantly confirmed. Otherwise, on each new bar of the range timeframe (detected by comparing <a href="/en/docs/series/itime" target="_blank">iTime</a>&nbsp;at shift 0 with "lastConfirmTime"), we count how many of the previous "ConfirmBars" bars closed decisively outside the range — above "rangeHigh" for bullish or below "rangeLow" for bearish. Only when the required number of confirming closes is reached do we set "confirmed" to true.</p> <p>We respect the "UseBreakoutFilter" input (though currently it simply passes the confirmation forward — room for future enhancements if you want to add more filters). Once confirmed, we calculate stop-loss and take-profit levels according to the chosen method. For a bullish breakout, if buy positions are below "MaxPositionsDir" and no long has been traded yet, we use dynamic mode to place stop-loss exactly at the range low (normalized) and take-profit at current ask plus the full range size multiplied by "RR_Ratio". In static mode, we place a stop-loss at a fixed "SL_Points" below the ask and take-profit the same distance times ratio above. We then execute the buy order via "obj_Trade.Buy", and on success (<a href="/en/docs/constants/errorswarnings/enum_trade_return_codes" target="_blank">TRADE_RETCODE_DONE</a>), log the entry details to the Experts tab, draw a blue upward arrow at the entry using "DrawEntryArrow", and set "tradedLong" to true to lock out further longs this session. The bearish side mirrors this exactly. Upon compilation, we get the following outcome.</p> <p style="text-align:center;"> <img width="700" height="505" src="https://c.mql5.com/2/181/Screenshot_2025-11-18_113102.png" loading="lazy" title="CONFIRMED SELL ORB SIGNAL" alt="CONFIRMED SELL ORB SIGNAL" style="vertical-align:middle;"/></p> <p>From the image, we can see that we open trades once we have a breakout. We now just need to manage the open positions by applying a trailing stop once the market moves in our favour, if we want to.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| Apply Points Trailing Stop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> ApplyPointsTrailing() {
&nbsp;&nbsp; <span class="keyword">double</span> point = <span class="predefines">_Point</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Get point</span>
&nbsp;&nbsp; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="functions">PositionsTotal</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Iterate positions</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (<span class="functions">PositionGetTicket</span>(i) &gt; <span class="number">0</span>) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Check ticket</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (<span class="functions">PositionGetString</span>(<span class="macro">POSITION_SYMBOL</span>) == <span class="predefines">_Symbol</span> &amp;&amp; <span class="functions">PositionGetInteger</span>(<span class="macro">POSITION_MAGIC</span>) == UniqueID) { <span class="comment">//--- Check symbol magic</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> sl = <span class="functions">PositionGetDouble</span>(<span class="macro">POSITION_SL</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> tp = <span class="functions">PositionGetDouble</span>(<span class="macro">POSITION_TP</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get TP</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">double</span> openPrice = <span class="functions">PositionGetDouble</span>(<span class="macro">POSITION_PRICE_OPEN</span>); <span class="comment">//--- Get open</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">ulong</span> ticket = <span class="functions">PositionGetInteger</span>(<span class="macro">POSITION_TICKET</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Get ticket</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (<span class="functions">PositionGetInteger</span>(<span class="macro">POSITION_TYPE</span>) == <span class="macro">POSITION_TYPE_BUY</span>) { <span class="comment">//--- Check buy</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">double</span> newSL = <span class="functions">NormalizeDouble</span>(<span class="functions">SymbolInfoDouble</span>(<span class="predefines">_Symbol</span>, <span class="macro">SYMBOL_BID</span>) - Trailing_Stop_Points * point, <span class="predefines">_Digits</span>); <span class="comment">//--- Calc new SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (newSL &gt; sl &amp;&amp; <span class="functions">SymbolInfoDouble</span>(<span class="predefines">_Symbol</span>, <span class="macro">SYMBOL_BID</span>) - openPrice &gt; Min_Profit_To_Trail_Points * point) { <span class="comment">//--- Check conditions</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_Trade.PositionModify(ticket, newSL, tp);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Modify position</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="functions">PositionGetInteger</span>(<span class="macro">POSITION_TYPE</span>) == <span class="macro">POSITION_TYPE_SELL</span>) { <span class="comment">//--- Check sell</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">double</span> newSL = <span class="functions">NormalizeDouble</span>(<span class="functions">SymbolInfoDouble</span>(<span class="predefines">_Symbol</span>, <span class="macro">SYMBOL_ASK</span>) + Trailing_Stop_Points * point, <span class="predefines">_Digits</span>); <span class="comment">//--- Calc new SL</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword">if</span> (newSL &lt; sl &amp;&amp; openPrice - <span class="functions">SymbolInfoDouble</span>(<span class="predefines">_Symbol</span>, <span class="macro">SYMBOL_ASK</span>) &gt; Min_Profit_To_Trail_Points * point) { <span class="comment">//--- Check conditions</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_Trade.PositionModify(ticket, newSL, tp);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Modify position</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp; }
}

<span class="comment">//--- Call the function per tick in the "OnTick" event handler</span>

<span class="keyword">if</span> (TrailingType == Trailing_Points &amp;&amp; <span class="functions">PositionsTotal</span>() &gt; <span class="number">0</span>) { <span class="comment">//--- Check trailing</span>
&nbsp;&nbsp; ApplyPointsTrailing();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Apply trailing</span>
}</pre> <p>Here, we implement the "ApplyPointsTrailing" function to dynamically trail the stop-loss when "Trailing_Points" mode is selected, protecting profits as the market moves in our favor. The function begins by storing the symbol's point value in "point" using <a href="/en/docs/predefined/_point" target="_blank">_Point</a>. It then iterates backward through all open positions to safely handle any modifications without index conflicts. For each valid ticket, we verify that the position belongs to the current symbol and carries our "UniqueID" magic number. We retrieve the current stop-loss, take-profit, open price, and ticket number.</p> <p>For buy positions, we calculate a potential new stop-loss by subtracting "Trailing_Stop_Points" × point from the current bid (normalized to the symbol's digits). We only apply the modification if this new level is higher than the existing stop-loss (tightening it) and the unrealized profit exceeds "Min_Profit_To_Trail_Points" × point, ensuring we only trail after a meaningful buffer. The position is updated via "obj_Trade.PositionModify" while preserving the original take-profit. The logic for sell positions mirrors this exactly. Finally, at the end of <a href="/en/docs/event_handlers/ontick" target="_blank">OnTick</a>, we check if trailing is enabled ("TrailingType == Trailing_Points") and there are open positions. If so, we immediately invoke "ApplyPointsTrailing" on every tick, providing real-time profit protection without delay. Finally, we need to delete our visualization objects when we remove the program from the chart.</p> <pre class="code"><span class="comment">//+------------------------------------------------------------------+</span>
<span class="comment">//| EA Stop Function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</span>
<span class="comment">//+------------------------------------------------------------------+</span>
<span class="keyword">void</span> <span class="functions">OnDeinit</span>(<span class="keyword">const</span> <span class="keyword">int</span> code) {
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), highLevelObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete high level</span>
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), lowLevelObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete low level</span>
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), highTextObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete high text</span>
&nbsp;&nbsp; <span class="functions">ObjectDelete</span>(<span class="functions">ChartID</span>(), lowTextObj);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete low text</span>
&nbsp;&nbsp; <span class="comment">// Clean dynamic objects</span>
&nbsp;&nbsp; <span class="functions">ObjectsDeleteAll</span>(<span class="functions">ChartID</span>(), <span class="string">"ORB_Rectangle_"</span>, <span class="macro">OBJ_RECTANGLE</span>);&nbsp;&nbsp;<span class="comment">//--- Delete rectangles</span>
&nbsp;&nbsp; <span class="functions">ObjectsDeleteAll</span>(<span class="functions">ChartID</span>(), <span class="string">"ORB_StartVLine_"</span>, <span class="macro">OBJ_VLINE</span>);&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete start vlines</span>
&nbsp;&nbsp; <span class="functions">ObjectsDeleteAll</span>(<span class="functions">ChartID</span>(), <span class="string">"ORB_EndVLine_"</span>, <span class="macro">OBJ_VLINE</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//--- Delete end vlines</span>
&nbsp;&nbsp; <span class="functions">ObjectsDeleteAll</span>(<span class="functions">ChartID</span>(), <span class="string">"ORB_StartTime_Text_"</span>, <span class="macro">OBJ_TEXT</span>);&nbsp;&nbsp;<span class="comment">//--- Delete start texts</span>
&nbsp;&nbsp; <span class="functions">ObjectsDeleteAll</span>(<span class="functions">ChartID</span>(), <span class="string">"ORB_EndTime_Text_"</span>, <span class="macro">OBJ_TEXT</span>);&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete end texts</span>
&nbsp;&nbsp; <span class="functions">ObjectsDeleteAll</span>(<span class="functions">ChartID</span>(), <span class="string">"EntryMarker_"</span>, <span class="macro">OBJ_ARROW</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//--- Delete entry markers</span>
}</pre> <p>In the <a href="/en/docs/event_handlers/ondeinit" target="_blank">OnDeinit</a>&nbsp;function, which runs when the program is removed from the chart or the terminal shuts down, we first delete the four persistent objects by name: the high and low horizontal levels via "highLevelObj" and "lowLevelObj", and their text labels with "highTextObj" and "lowTextObj". We then use <a href="/en/docs/objects/objectdeleteall" target="_blank">ObjectsDeleteAll</a>&nbsp;to remove every dynamically created object from the current session and all previous ones. This complete cleanup prevents object accumulation across multiple sessions or chart reloads. Upon compilation, we get the following outcome when the trailing stop is enabled.</p> <p style="text-align:center;"> <img width="700" height="616" src="https://c.mql5.com/2/181/ORB_GIF.gif" loading="lazy" title="COMPLETE ORB GIF" alt="COMPLETE ORB GIF" style="vertical-align:middle;"/></p> <p>From the visualization, we can see that we define the ranges, open positions, and manage them by applying trailing stops when needed, hence achieving our objectives. The thing that remains is backtesting the program, and that is handled in the next section.</p> <p><br/></p> <h3 id="para4">Backtesting</h3> <p>After thorough backtesting, we have the following results.</p> <p>Backtest graph:</p> <p style="text-align:center;"> <img width="700" height="418" src="https://c.mql5.com/2/181/Screenshot_2025-11-18_123022.png" loading="lazy" title="GRAPH" alt="GRAPH" style="vertical-align:middle;"/></p> <p>Backtest report:</p> <p style="text-align:center;"> <img width="700" height="418" src="https://c.mql5.com/2/181/Screenshot_2025-11-18_123035.png" loading="lazy" title="REPORT" alt="REPORT" style="vertical-align:middle;"/></p> <p><br/></p> <h3 id="para5">Conclusion</h3> <p>In conclusion, we’ve developed a session-based <a href="/go?link=https://www.fluxcharts.com/articles/trading-strategies/common-strategies/opening-range-breakout" title="https://www.fluxcharts.com/articles/trading-strategies/common-strategies/opening-range-breakout" rel="nofollow" target="_blank">Opening Range Breakout (ORB)</a> system in <a href="/" target="_blank">MQL5</a> that allows custom session start times and opening range durations in minutes, automatically determines the true high and low on a selected timeframe, detects breakouts with optional multi-bar close confirmation, and executes trades only in the breakout direction.</p> <div class="atten"> <p>Disclaimer: This article is for educational purposes only. Trading carries significant financial risks, and market volatility may result in losses. Thorough backtesting and careful risk management are crucial before deploying this program in live markets.</p> </div> <p>With this session-based Opening Range Breakout strategy, you’re equipped to trade intraday breakout setups in any chosen market session, ready for further optimization in your trading journey. Happy trading!</p>
      </div>
<div id="cb_20339" class="attachBlock">
  <strong>Attached files</strong> |
  <div class="grouped-attachments-help">
    <a title="Download all attachments in the single ZIP archive" href="/en/articles/download/20339.zip">
      <i class="attach-icon attach-icon_zip"></i>Download ZIP
    </a>
  </div>
    <div class="attachItem">
      <a title="Download ORB_Opening_Range_Breakout_EA.mq5" href="/en/articles/download/20339/ORB_Opening_Range_Breakout_EA.mq5"><i class="attach-icon attach-icon_mq5"></i>ORB_Opening_Range_Breakout_EA.mq5</a>
      <span class="attachSize">(23.39 KB)</span>
    </div>
</div>
    </div>

  <div class="copyright">
    <p><strong>Warning:</strong> All rights to these materials are reserved by MetaQuotes Ltd. Copying or reprinting of these materials in whole or in part is prohibited.</p>
      <p>This article was written by a user of the site and reflects their personal views. MetaQuotes Ltd is not responsible for the accuracy of the information presented, nor for any consequences resulting from the use of the solutions, strategies or recommendations described.</p>
  </div>



  <div class="other-author-articles ui">
    <h4 class="other-author-articles__title">Other articles by this author</h4>
    <ul class="other-author-articles__list">
        <li>
          <a href="/en/articles/20323" data-fz-event="MQL5+Article+From+Author+Article">Automating Trading Strategies in MQL5 (Part 41): Candle Range Theory (CRT) – Accumulation, Manipulation, Distribution (AMD)</a>
        </li>
        <li>
          <a href="/en/articles/20254" data-fz-event="MQL5+Article+From+Author+Article">Building AI-Powered Trading Systems in MQL5 (Part 6): Introducing Chat Deletion and Search Functionality</a>
        </li>
        <li>
          <a href="/en/articles/20221" data-fz-event="MQL5+Article+From+Author+Article">Automating Trading Strategies in MQL5 (Part 40): Fibonacci Retracement Trading with Custom Levels</a>
        </li>
        <li>
          <a href="/en/articles/20249" data-fz-event="MQL5+Article+From+Author+Article">Building AI-Powered Trading Systems in MQL5 (Part 5): Adding a Collapsible Sidebar with Chat Popups</a>
        </li>
        <li>
          <a href="/en/articles/20229" data-fz-event="MQL5+Article+From+Author+Article">MQL5 Trading Tools (Part 10): Building a Strategy Tracker System with Visual Levels and Success Metrics</a>
        </li>
        <li>
          <a href="/en/articles/20167" data-fz-event="MQL5+Article+From+Author+Article">Automating Trading Strategies in MQL5 (Part 39): Statistical Mean Reversion with Confidence Intervals and Dashboard</a>
        </li>
    </ul>
  </div>


  <div class="article__last-comments" id="articleAdditional">
    

<div class="comments-preview">
    <div class="title">
      <span></span><b>
         Last comments |
 <a href="/en/forum/500775">Go to discussion</a>
      </b>
        (3)
    </div>
    <div>
        
        <div class="comment">
          <div class="user"><div class="frame"><div class="bg"><img src="https://c.mql5.com/avatar/2023/4/6438c14d-e2f0.png" srcset="https://c.mql5.com/avatar/2023/4/6438c14d-e2f0_big.png 2x" alt="linfo2" title="linfo2" data-user-login="NeilHazelwood" loading="lazy" width="60" height="60"></div></div></div>

          <div class="text">
            <div>
              <b><a class="author" href="/en/users/neilhazelwood" data-user-login="NeilHazelwood">linfo2</a></b>
              |
              <span class="comment__date">26 Nov 2025 at 22:36</span>
              <a id="comment_58604211"></a>
              <span class="commands"><span class="command newMessageLink"><a title="Send a private message to linfo2" href="/en/users/deszkmihaly67/messages" onclick="if(window.openChatWith){window.openChatWith('neilhazelwood',16208239,'linfo2');return false;}if(window.doPost) { window.doPost(null,'/en/users/deszkmihaly67/messages',null,{'user':'NeilHazelwood'}); return false; }"></a></span>
<span class="command translateMenu translateLink" data-contentId="content58604211" data-sourceLang="en" data-targetLang="en" data-moduleId="3" data-typeId="17" data-entityId="58604211" ><a href="#" class="selected" title="Translate into any of the 15 languages">EN</a></span></span>

            </div>
            <div class="content" id="content58604211">
              Hi Allan and thanks for your continuing contributions , nicely put together than you , I was wondering if you have any solutions for automating the <a href="/en/docs/constants/tradingconstants/positionproperties#enum_position_property_integer" title="MQL5 documentation: Position Properties" class="linkator"><span class="mark">opening time</span></a> ? generally I use&nbsp; broker time change but it is not always accurate for me as I am in NZ my broker is in AU there are factors like austalias offset and times when there is a tokyo offset and a new york offset . I have had trouble getting this to work , any suggestions appreciated&nbsp; . chat gpt gives me&nbsp; me a scipt that checks each coutnries daylight saving dates, was wondering if there was a more eloquent solution
            </div>
          </div>
        </div>
        <div class="comment">
          <div class="user"><div class="frame"><div class="bg"><img src="https://c.mql5.com/avatar/2022/11/637df59b-9551.jpg" srcset="https://c.mql5.com/avatar/2022/11/637df59b-9551_big.jpg 2x" alt="Allan Munene Mutiiria" title="Allan Munene Mutiiria" data-user-login="29210372" loading="lazy" width="60" height="60"></div></div></div>

          <div class="text">
            <div>
              <b><a class="author" href="/en/users/29210372" data-user-login="29210372">Allan Munene Mutiiria</a></b>
              |
              <span class="comment__date">27 Nov 2025 at 08:09</span>
              <a id="comment_58606374"></a>
              <span class="commands"><span class="command newMessageLink"><a title="Send a private message to Allan Munene Mutiiria" href="/en/users/deszkmihaly67/messages" onclick="if(window.openChatWith){window.openChatWith('29210372',6458963,'Allan Munene Mutiiria');return false;}if(window.doPost) { window.doPost(null,'/en/users/deszkmihaly67/messages',null,{'user':'29210372'}); return false; }"></a></span>
<span class="command translateMenu translateLink" data-contentId="content58606374" data-sourceLang="en" data-targetLang="en" data-moduleId="3" data-typeId="17" data-entityId="58606374" ><a href="#" class="selected" title="Translate into any of the 15 languages">EN</a></span></span>

            </div>
            <div class="content" id="content58606374">
              <div class="fquote"> <strong><span style="color:#42639C;">linfo2 <a href="/en/forum/500775#comment_58604211">#</a></span>:</strong><br/> Hi Allan and thanks for your continuing contributions , nicely put together than you , I was wondering if you have any solutions for automating the <a href="/en/docs/constants/tradingconstants/positionproperties#enum_position_property_integer" title="MQL5 documentation: Position Properties" class="linkator"><span class="mark">opening time</span></a> ? generally I use&nbsp; broker time change but it is not always accurate for me as I am in NZ my broker is in AU there are factors like austalias offset and times when there is a tokyo offset and a new york offset . I have had trouble getting this to work , any suggestions appreciated&nbsp; . chat gpt gives me&nbsp; me a scipt that checks each coutnries daylight saving dates, was wondering if there was a more eloquent solution </div> <p>Hello. Thanks for the kind feedback. You can define the time in your code by using the local time instead of the broker's time or you can define yours. See example.</p> <p>Local time:</p> <pre class="code"><span class="functions">TimeLocal</span>()</pre> <p>You can also use direct time as per your computer's settings using the trade server:</p> <pre class="code"><span class="functions">TimeTradeServer</span>()</pre> <p>GMT Time:</p> <pre class="code"><span class="functions">TimeGMT</span>()</pre> <p>You could also define your dedicated date and time as below:</p> <pre class="code"><span class="keyword">datetime</span> my_time = <span class="string">D'2025.11.27 11:07'</span>
<span class="predefines">MqlDateTime</span> my_struct_time;
</pre> <p>It is all upon you to choose the best approach. Thanks.</p>
            </div>
          </div>
        </div>
        <div class="comment">
          <div class="user"><div class="frame"><div class="bg"><img src="https://c.mql5.com/avatar/2010/10/4CA7CFA0-1F0C.jpg" srcset="https://c.mql5.com/avatar/2010/10/4CA7CFA0-1F0C_big.jpg 2x" alt="Stanislav Korotky" title="Stanislav Korotky" data-user-login="marketeer" loading="lazy" width="60" height="60"></div></div></div>

          <div class="text">
            <div>
              <b><a class="author" href="/en/users/marketeer" data-user-login="marketeer">Stanislav Korotky</a></b>
              |
              <span class="comment__date">27 Nov 2025 at 11:46</span>
              <a id="comment_58607740"></a>
              <span class="commands"><span class="command newMessageLink"><a title="Send a private message to Stanislav Korotky" href="/en/users/deszkmihaly67/messages" onclick="if(window.openChatWith){window.openChatWith('marketeer',25760,'Stanislav Korotky');return false;}if(window.doPost) { window.doPost(null,'/en/users/deszkmihaly67/messages',null,{'user':'marketeer'}); return false; }"></a></span>
<span class="command translateMenu translateLink" data-contentId="content58607740" data-sourceLang="en" data-targetLang="en" data-moduleId="3" data-typeId="17" data-entityId="58607740" ><a href="#" class="selected" title="Translate into any of the 15 languages">EN</a></span></span>

            </div>
            <div class="content" id="content58607740">
              <div class="fquote"> <strong><span style="color:#42639C;">linfo2 <a href="/en/forum/500775#comment_58604211">#</a></span>:</strong><br/> Hi Allan and thanks for your continuing contributions , nicely put together than you , I was wondering if you have any solutions for automating the <a href="/en/docs/constants/tradingconstants/positionproperties#enum_position_property_integer" title="MQL5 documentation: Position Properties" class="linkator"><span class="mark">opening time</span></a> ? generally I use&nbsp; broker time change but it is not always accurate for me as I am in NZ my broker is in AU there are factors like austalias offset and times when there is a tokyo offset and a new york offset . I have had trouble getting this to work , any suggestions appreciated&nbsp; . chat gpt gives me&nbsp; me a scipt that checks each coutnries daylight saving dates, was wondering if there was a more eloquent solution </div> <p>Your problem is not clear enough. But you can try the extensive&nbsp;<a href="/en/code/48419" target="_blank">Local Timezones and Local Session Hours</a> library or more simple&nbsp;<a href="/en/code/52557" target="_blank">TimeServerDaylightSavings</a>. Without time adjustments you can't reliably test your strategy on a history which usually affected by DST and timezone switches.&nbsp;<span>Or probably you want&nbsp;</span><a href="/en/code/48650" target="_blank">Determine Broker's Daylight (DST) schedule</a><span><span>&nbsp;to detect timezone changes online.</span></span></p> <p><span><span></span></span>Unfortunately, built-in MQL5 API does not provide a ready-made and more eloquent solution.</p>
            </div>
          </div>
        </div>
    </div>

  
</div>

  </div>


    <div class="articles-bottom-list">
        <div class="articles-bottom-list__row">
          <div class="articles-bottom-list__column">
              <div class="articles-bottom-list__item">
                <img alt="From Basic to Intermediate: Struct (I)" src="https://c.mql5.com/2/117/Do_b8sico_ao_intermediario_Struct_I___LOGO.png" loading="lazy" width="60" height="60" class="articles-bottom-list__avatar">
                <a href="/en/articles/15730" data-fz-event="MQL5+Article+Next+Article" class="articles-bottom-list__title">From Basic to Intermediate: Struct (I)</a>
                <div class="articles-bottom-list__desc">Today we will begin to study structures in a simpler, more practical, and comfortable way. Structures are among the foundations of programming, whether they are structured or not. I know many people think of structures as just collections of data, but I assure you that they are much more than just structures. And here we will begin to explore this new universe in the most didactic way.</div>
              </div>
          </div>
          <div class="articles-bottom-list__column">
              <div class="articles-bottom-list__item">
                <img alt="MetaTrader 5 Machine Learning Blueprint (Part 6): Engineering a Production-Grade Caching System" src="https://c.mql5.com/2/182/20302-metatrader-5-machine-learning-logo.png" loading="lazy" width="60" height="60" class="articles-bottom-list__avatar">
                <a href="/en/articles/20302" data-fz-event="MQL5+Article+Next+Article" class="articles-bottom-list__title">MetaTrader 5 Machine Learning Blueprint (Part 6): Engineering a Production-Grade Caching System</a>
                <div class="articles-bottom-list__desc">Tired of watching progress bars instead of testing trading strategies? Traditional caching fails financial ML, leaving you with lost computations and frustrating restarts. We&#x27;ve engineered a sophisticated caching architecture that understands the unique challenges of financial data—temporal dependencies, complex data structures, and the constant threat of look-ahead bias. Our three-layer system delivers dramatic speed improvements while automatically invalidating stale results and preventing costly data leaks. Stop waiting for computations and start iterating at the pace the markets demand.</div>
              </div>
          </div>
        </div>
        <div class="articles-bottom-list__row">
          <div class="articles-bottom-list__column">
              <div class="articles-bottom-list__item">
                <img alt="The MQL5 Standard Library Explorer (Part 4): Custom Signal Library" src="https://c.mql5.com/2/183/20266-the-mql5-standard-library-explorer-logo.png" loading="lazy" width="60" height="60" class="articles-bottom-list__avatar">
                <a href="/en/articles/20266" data-fz-event="MQL5+Article+Next+Article" class="articles-bottom-list__title">The MQL5 Standard Library Explorer (Part 4): Custom Signal Library</a>
                <div class="articles-bottom-list__desc">Today, we use the MQL5 Standard Library to build custom signal classes and let the MQL5 Wizard assemble a professional Expert Advisor for us. This approach simplifies development so that even beginner programmers can create robust EAs without in-depth coding knowledge, focusing instead on tuning inputs and optimizing performance. Join this discussion as we explore the process step by step.</div>
              </div>
          </div>
          <div class="articles-bottom-list__column">
              <div class="articles-bottom-list__item">
                <img alt="Market Positioning Codex for VGT with Kendall&#x27;s Tau and Distance Correlation" src="https://c.mql5.com/2/182/20271-market-positioning-codex-for-logo.png" loading="lazy" width="60" height="60" class="articles-bottom-list__avatar">
                <a href="/en/articles/20271" data-fz-event="MQL5+Article+Next+Article" class="articles-bottom-list__title">Market Positioning Codex for VGT with Kendall&#x27;s Tau and Distance Correlation</a>
                <div class="articles-bottom-list__desc">In this article, we look to explore how a complimentary indicator pairing can be used to analyze the recent 5-year history of Vanguard Information Technology Index Fund ETF. By considering two options of algorithms, Kendall’s Tau and Distance-Correlation, we look to select not just an ideal indicator pair for trading the VGT, but also suitable signal-pattern pairings of these two indicators.</div>
              </div>
          </div>
        </div>
    </div>

<div class="clear-fix"></div>

<div id='wdausxxqrpvhekbwjrjlhqjghyhesrqqau' class="r26nklh8wss4ljjhz r26nklh8wss4ljjhz_articles-view g9z0qx14h"></div>
    

    


    </article>
  </div>



<div aria-hidden="true" class="footer  desktop" id="footer">
  <ul class="links  links_desktop">
      <li id="navFooterCommunity">
        <b>MQL5.community</b>
        <nav>
          <ul>
            <li><a href="https://web.metatrader.app/terminal?mode=demo&amp;lang=en" target="_blank" rel="nofollow noopener" data-fz-event="MQL5+Footer+Trading">Online trading / WebTerminal</a></li>
            <li><a href="/en/code" data-fz-event="MQL5+Footer+CodeBase">Free technical indicators and robots</a></li>
            <li><a href="/en/articles" data-fz-event="MQL5+Footer+Articles">Articles about programming and trading</a></li>
            <li><a href="/en/job" data-fz-event="MQL5+Footer+Job">Order trading robots on the Freelance</a></li>
            <li><a href="/en/market" data-fz-event="MQL5+Footer+Market">Market of Expert Advisors and applications&#x9;</a></li>
            <li><a href="/en/signals" data-fz-event="MQL5+Footer+Signals">Follow forex signals</a></li>
            <li><a href="/en/vps" data-fz-event="MQL5+Footer+VPS">Low latency forex VPS</a></li>
            <li><a href="/en/forum" data-fz-event="MQL5+Footer+Forum">Traders forum</a></li>
            <li><a href="/en/blogs" data-fz-event="MQL5+Footer+Blogs">Trading blogs</a></li>
            <li><a rel="nofollow" href="/en/charts" data-fz-event="MQL5+Footer+Charts">Charts</a></li>
          </ul>
        </nav>
      </li>
      <li id="navFooterMt5">
        <b>MetaTrader 5</b>
        <nav>
          <ul>
            <li><a rel="nofollow noopener" href="https://www.metatrader5.com" data-fz-event="MQL5+Footer+MetaTrader+5"><span class="nobr">MetaTrader 5</span> Trading Platform</a></li>
            <li><a rel="nofollow noopener" href="https://www.metatrader5.com/en/releasenotes" data-fz-event="MQL5+Footer+MetaTrader+5"><span class="nobr">MetaTrader 5</span> latest updates</a></li>
            <li><a rel="nofollow noopener" href="https://www.metatrader5.com/en/news" data-fz-event="MQL5+Footer+MetaTrader+5">News, implementations and technology</a></li>
            <li><a rel="nofollow noopener" href="https://www.metatrader5.com/en/terminal/help" data-fz-event="MQL5+Footer+MetaTrader+5"><span class="nobr">MetaTrader 5</span> User Manual</a></li>
            <li><a href="/en/docs" data-fz-event="MQL5+Footer+Docs">MQL5 language of trading strategies</a></li>
            <li><a rel="nofollow noopener" href="https://cloud.mql5.com" data-fz-event="MQL5+Footer+Cloud">MQL5 Cloud Network</a></li>
            <li><a rel="noopener" href="https://forge.mql5.io/?lang=en" data-fz-event="MQL5+Footer+Forge" target="_blank">MQL5 Algo Forge</a></li>
              <li><a rel="nofollow noopener" href="https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&amp;utm_campaign=download" data-fz-event="MetaTrader+5+Desktop+Download+Footer">Download <span class="nobr">MetaTrader 5</span></a></li>
              <li><a rel="nofollow noopener" href="https://www.metatrader5.com/en/terminal/help/start_advanced/installation" data-fz-event="MQL5+Footer+MetaTrader+5">Install Platform</a></li>
              <li><a rel="nofollow noopener" href="https://www.metatrader5.com/en/terminal/help/start_advanced/deinstallation" data-fz-event="MQL5+Footer+MetaTrader+5">Uninstall Platform</a></li>
          </ul>
        </nav>

      </li>
    <li id="navFooterWebsite">
        <b >Website</b>
        <nav>
          <ul>
            <li><a rel="nofollow" href="/en/about" data-fz-event="MQL5+Footer+About">About</a></li>
              <li><a href="/en/wall" data-fz-event="MQL5+Footer+Wall">Timeline</a></li>
            <li><a rel="nofollow" href="/en/about/terms" data-fz-event="MQL5+Footer+About">Terms and Conditions</a></li>
            <li><a rel="nofollow" href="/en/about/autopayments" data-fz-event="MQL5+Footer+About">Recurring Payment Agreement</a></li>
            <li><a rel="nofollow" href="/en/about/agencyagreement" data-fz-event="MQL5+Footer+About">Agency Agreement – Offer</a></li>
            <li><a rel="nofollow" href="/en/about/privacy" data-fz-event="MQL5+Footer+About">Privacy and Data Protection Policy</a></li>
            <li><a rel="nofollow" href="/en/about/cookies" data-fz-event="MQL5+Footer+About">Cookies Policy</a></li>
            <li>
                <a rel="nofollow" href="/en/contact" data-fz-event="MQL5+Footer+Contacts">Contacts and requests</a>
            </li>
          </ul>
        </nav>
    </li>

      <li>
        <div class="footer__products">
            <div class="footer__product">
              <a target="_blank" rel="nofollow noopener" href="https://www.metatrader5.com" class="footer__product-name">MetaTrader 5</a>
              <div class="footer__product-links">
              <a rel="nofollow noopener" href="https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon windows" data-fz-event="MetaTrader+5+Desktop+Download+Footer"><div class="footer__product-link-hint footer__product-link-hint-short">Download MetaTrader 5 for Windows</div></a>
              <a rel="nofollow noopener" href="https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon macos" data-fz-event="MetaTrader+5+Desktop+Download+Footer"><div class="footer__product-link-hint footer__product-link-hint-short">Download MetaTrader 5 for MacOS</div></a>
              <a rel="nofollow noopener" href="https://www.mql5.com/en/articles/625?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon linux" data-fz-event="MetaTrader+5+Desktop+Download+Footer"><div class="footer__product-link-hint footer__product-link-hint-short">Download MetaTrader 5 for Linux</div></a>
              <a rel="nofollow noopener" href="https://web.metatrader.app/terminal?mode=demo&amp;lang=en" class="icon web"><div  class="footer__product-link-hint footer__product-link-hint-short">Open MetaTrader 5 WebTerminal</div></a>
              <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/mt5/ios?utm_source=www.mql5.com&amp;utm_campaign=install.metaquotes&amp;hl=en" class="icon ios" data-fz-event="MetaTrader+5+iOS+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/j1YndT0ELP9.png)">Scan to install from App Store</div></a>
              <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/mt5/android?utm_source=www.mql5.com&amp;utm_campaign=install.metaquotes&amp;hl=en" class="icon android" data-fz-event="MetaTrader+5+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/kLq7f3IjZ79.png)">Scan to install from Google Play</div></a>
              <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/mt5/android/app-gallery?utm_source=www.mql5.com&amp;utm_campaign=install.metaquotes" class="icon huawei" data-fz-event="MetaTrader+5+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/ZgFlSvLLbPn.png)">Scan to install from Huawei AppGallery</div></a>
              <a rel="nofollow noopener" href="https://download.mql5.com/cdn/web/metaquotes.software.corp/mt5/metatrader5.apk?utm_source=www.mql5.com&amp;utm_campaign=install.metaquotes" class="icon ark" data-fz-event="MetaTrader+5+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/Lwmc2V3KIPA.png)">Scan to get Android APK file</div></a>
              </div>
            </div>
            <div>
              <div class="footer__product">
                <a target="_blank" rel="nofollow noopener" href="https://www.metatrader5.com/en/news/2270" class="footer__product-name">MQL5 Channels</a>
                <div class="footer__product-links">
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/mql5.channels/ios?utm_source=www.mql5.com&amp;utm_campaign=download&amp;hl=en" class="icon ios" data-fz-event="MQL5+Channels+iOS+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/bZWf3CH-YUJ.png)">Scan to install from App Store</div></a>
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/mql5.channels/android?utm_source=www.mql5.com&amp;utm_campaign=download&amp;hl=en" class="icon android" data-fz-event="MQL5+Channels+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/3DvQEZrJjjS.png)">Scan to install from Google Play</div></a>
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/mql5.channels/android/app-gallery?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon huawei" data-fz-event="MQL5+Channels+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/S7GLL6gia6p.png)">Scan to install from Huawei AppGallery</div></a>
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/web/metaquotes.software.corp/mql5channels/mql5channels.apk?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon ark" data-fz-event="MQL5+Channels+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/GavZeMoJbi7.png)">Scan to get Android APK file</div></a>
                </div>
              </div>
              <div class="footer__product">
                <a target="_blank" rel="nofollow noopener" href="https://www.tradays.com/en/download?utm_source=www.mql5.com&amp;utm_campaign=download" data-fz-event="MQL5+Footer+Download+Tradays" class="footer__product-name">Economic Calendar</a>
                <div class="footer__product-links">
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/tradays/ios?utm_source=www.mql5.com&amp;utm_campaign=download&amp;hl=en" class="icon ios" data-fz-event="Tradays+iOS+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/CA1pc8ZTZxp.png)">Scan to install from App Store</div></a>
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/tradays/android?utm_source=www.mql5.com&amp;utm_campaign=download&amp;hl=en" class="icon android" data-fz-event="Tradays+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/BR4u5sNJgnA.png)">Scan to install from Google Play</div></a>
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/mobile/tradays/android/app-gallery?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon huawei" data-fz-event="Tradays+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/CDbwhhgyysd.png)">Scan to install from Huawei AppGallery</div></a>
                <a rel="nofollow noopener" href="https://download.mql5.com/cdn/web/metaquotes.software.corp/tradays/tradays.apk?utm_source=www.mql5.com&amp;utm_campaign=download" class="icon ark" data-fz-event="Tradays+Android+Download+Footer"><div class="footer__product-link-hint" style="background-image: url(https://c.mql5.com/qr/VGWFy3By-09.png)">Scan to get Android APK file</div></a>
                </div>
              </div>
            </div>
          </div>

          <div class="footer__networks">
            <div class="footer__networks-list">
            <a href="https://www.facebook.com/mql5.community/" target="_blank" rel="nofollow" title="Facebook"><i class="icons-networks icons-networks_fb"></i></a><a href="https://t.me/mql5dev" target="_blank" rel="nofollow" title="Telegram"><i class="icons-networks icons-networks_tg"></i></a><a href="https://x.com/mql5com" target="_blank" rel="nofollow" title="X (Twitter)"><i class="icons-networks icons-networks_tw"></i></a>
            </div>
            <span>Follow us on socials for top articles and CodeBase updates</span>
          </div>
  
        <div class="footer__other">
          <div class="footer__not-a-broker">Not a broker, no real trading accounts</div>
          <div class="copyright">35 Dodekanisou str, Germasogeia, 4043,&nbsp;Limassol,&nbsp;Cyprus</div>
          <div class="copyright">Copyright 2000-2025, <span class="nobr">MetaQuotes Ltd</span></div>
        </div>
      </li>
  </ul>
</div>



<div class="shadow-layer" id="layer"></div>



<script type='text/javascript'>
		(function (a, e, f, g, b, c, d) { a[b] || (a.FintezaCoreObject = b, a[b] = a[b] || function () { (a[b].q = a[b].q || []).push(arguments) }, a[b].l = 1 * new Date, c = e.createElement(f), d = e.getElementsByTagName(f)[0], c.async = !0, c.defer = !0, c.src = g, d && d.parentNode && d.parentNode.insertBefore(c, d)) })
      (window, document, "script", "/ff/core.js", "fz");
		window.fz("register", "website", {
      id: "sqjxkxkswybhifrohpyooonwgbvsfzmayq",
			trackLinks: true
		});
        mqGlobal.AddOnReady(function () { Mql5Cookie.init('mql5.com', '6428434430243088515'); });
mqGlobal.AddOnReady(function(){if(!window.Pocket){window.Pocket=new PocketManager();}});mqGlobal.AddOnReady(function(){if(!window.translateManager){window.translateManager=new Translate(undefined,'Error: failed to translate. Please try again later.');}if(document.querySelectorAll){var translateElements=document.querySelectorAll(".translateMenu");if(translateElements){var i=0,count=translateElements.length;for(i;i<count;i++){(function(i){var contentid=dataset(translateElements[i],"contentid"),sourcelang=dataset(translateElements[i],"sourcelang"),targetlang=dataset(translateElements[i],"targetlang"),moduleid=parseInt(dataset(translateElements[i],"moduleid")),typeid=parseInt(dataset(translateElements[i],"typeid")),entityid=parseInt(dataset(translateElements[i],"entityid"));Core.AddHandler(translateElements[i],"mouseover",function(){return translateManager.SetMenu(this,contentid,sourcelang,targetlang,moduleid,typeid,entityid);});})(i);}}}});function FriendsShort(title){this.showFriendWindow=function(linkObj,userLogin,fullName,worksAt,rating,imagePath,country,position,website){var container=createElement(null,"DIV",{className:"friendInfoContainer ui complaint-window"});var leftContainer=createElement(container,"DIV",{className:"leftContainer"});var avatarBlock=createElement(leftContainer,"DIV",{className:"user"});createElement(avatarBlock,"IMG",{src:imagePath,width:"60",height:"60",title:fullName,loading:"lazy"});var ratingBlock=createElement(avatarBlock,"SPAN",{className:"rating"});ratingBlock.innerHTML=rating;var detailsContainer=createElement(container,"DIV",{className:"detailsContainer"});var nameBlock=createElement(detailsContainer,"P",{className:"name"});nameBlock.innerHTML=fullName;var worksBlock=createElement(detailsContainer,"P",{className:"works"});if(position!=""||worksAt!="")worksBlock.innerHTML+="Works: ";if(position!="")worksBlock.innerText+=position;if(worksAt!=""){if(position!="")worksBlock.innerHTML+=" ";worksBlock.innerText+="at ";if(website!=""){createElement(worksBlock,"A",{target:"_blank",href:website}).innerText=worksAt;}}var livesBlock=createElement(detailsContainer,"P",{className:"lives"});if(country!="")livesBlock.innerHTML="Lives: "+country;createElement(container,"DIV",{className:"splitter"});var operationsContainer=createElement(container,"DIV",{className:"complaint-window__item complaint-window__btns"});createElement(operationsContainer,"button",{className:"button button_green",innerText:"Add",onclick:function(){addFriendRequest(linkObj,userLogin);}});var initialWidth=360;var initialHeight=105;window.Dialog.show(title,container,initialWidth,initialHeight,function(){Dialog.hide();},null,false,null,false,'fixed');};function addFriendRequest(linkObj,friendLogin){Ajax.post('/en/users/deszkmihaly67/friends',{user:friendLogin,act:"add",__signature:'36a89d1b6ff77bf003fd4009c9d0a49a'},false,{onready:function(){linkObj.parentNode.style.display="none";Dialog.hide();}});};}window.friendShort=new FriendsShort('Do you want to add user to friends?');window.fz("show","wdausxxqrpvhekbwjrjlhqjghyhesrqqau");window.mqGlobal.AddOnLoad(function(){window.fpush('MQL5+Article+Open');Articles.CheckOnScrollDown();});mqGlobal.AddOnLoad(function(){window.tooltipUserInfo.init();});mqGlobal.AddOnReady(function(){{window.initHeaderSearch('','https://www.mql5.com/en/search');}});</script><script type="text/javascript">mqGlobal.AddOnReady(function(){window.initSuggestions("headerSearchKeyword","en","https://search.mql5.com/api/query","https://www.mql5.com/en/users_search/suggestion");});mqGlobal.AddOnReady(function(){var localization={"friendsHeader":"Friends","newMessageHeader":"Add new message","userToLabel":"Part of the user's name or login","gotoMessages":"Go to messages list","gotoMessage":"Go to chat","otherUsersHeader":"Other users","returnToList":"Return to messages list (ESC)","closeChat":"Close chat","attachedFilesHeader":"Attached files","attachFileTitle":"Attach file","sendMessageTitle":"Reply","expandWindow":"Expand chat window","minimizeWindow":"Reduce chat window","searchUserPlaceholder":"Part of the user's name or login","searchChannelPlaceholder":"Channels","errorOccuredMessage":"An error occurred. Please try again later.","systemYouInvited":"You have been invited to chat {0}","systemUserInvited":"{0} invited {1}","systemChatUserLeft":"{0} left the chat","systemChatUserRemoved":"{0} removed {1} from chat","systemChannelUserRemoved":"{0} removed {1} from channel","systemChannelPublic":"{0} made the channel public","systemChannelPrivate":"{0} made the channel private","systemChatLimited":"{0} made the chat limited","systemChatUnlimited":"{0} made the chat not limited","systemChatClosed":"{0} closed the chat","systemChannelClosed":"Channel is now closed","systemChatReopened":"{0} reopened the chat","systemChannelReopened":"Channel reopened","systemChatRename":"{0} changed the chat name to {1}","systemChannelRename":"Channel name changed to {0}","systemChatCreate":"{0} created the chat {1}","systemChannelCreate":"Channel {0} created","systemChatPrivate":"{0} made the chat private","systemChatPublic":"{0} made the chat public","subscribe":"Subscribe","unsubscribe":"Unsubscribe","ofSubscribers":"{0} subscribers","ofUsers":"{0} members","messages":"Messages","users":"Users","channels":"Channels","unreadMessages":"Unread messages","deleteChat":"delete","deleteChatConfirm":"Are you sure want to delete chat?","allChats":"All chats","privateChats":"Private chats","groupChats":"Group chats","allChatsShort":"All","privateChatsShort":"Private","groupChatsShort":"Groups","recommendedChannels":"Recommended channels","members":"Members","popularChannels":"Popular channels","startChat":"Start a chat","createChannel":"Create a channel","createGroup":"Create a group","searchPlaceholder":"Enter part of a name or login of a person you want to chat with","en":"English","ru":"Русский","de":"Deutsch","es":"Español","pt":"Português","ja":"日本語","zh":"中文","ar":"العربية","tr":"Türkçe","it":"Italiano","ko":"한국어","fr":"Français","foundEmpty":"Your search did not match any documents","close":"Close","chatNamePlaceholder":"Set a short and clear name","channelCreation":"Creating a channel","image":"Image","fileDesc":"JPG, GIF or PNG image","chatDesc":"Description","channelDescPlaceholder":"Add a clear channel description","links":"Links","linksPlaceholder":"Comma-separated list of links","channelLanguage":"Channel language","addMembers":"Add members","selectedMembers":"{0} members selected","append":"Add","groupCreation":"Creating a group","publicChannel":"Public channel","privateChannel":"Private channel","publicChannelDesc":"Any user is able to find the channel and subscribe to it","privateChannelDesc":"The channel is available to invited users only","urlChannel":"Channel link","channelAvatar":"Channel avatar","selectFile":"Select a file","delete":"delete","channel":"Channel","group":"Group chat","edit":"edit","editing":"Editing","inviteLinkExists":"This link name is already in use, please set another one","save":"Save","publicChat":"Public chat","privateChat":"Private chat","publicChatDesc":"Any user is able to find and join the chat","privateChatDesc":"The chat is available to invited users only","open":"Open","chatLanguage":"Chat language","isLimited":"Regular chat users can add new members","emptyAddMember":"To add new members, use the search","mql5Members":"MQL5 members","friends":"Friends","friendAddToChat":"Add to friends","friendAddToChatNote":"Add the user as a friend. You can see activity of your friends on the website and communicate with them easily.","admin":"Administrator","owner":"Owner","moderator":"Moderator","notSupportedWebsoket":"WebSocket is not supported by this browser.","cancel":"Cancel","deletion":"Deletion","deletionTextChannel":"Do you really want to delete the {0} channel?","deletionTextGroup":"Do you really want to delete the {0} group?","deleteUpper":"Delete","block":"-","unblock":"-","emptyChatsList":'<p>You have no chats.</p><p>Please use the search or create a new chat on the <a href="{0}">messages</a> page</p>',"deletedAccount":"Deleted account","other":"Other","groupDescPlaceholder":"Add a clear chat description","widgetErrorOccured":"An error occurred. Please try again later.","pleaseUploadAvatar":"Please upload the chat avatar","pleaseUploadAvatarChannel":"Please upload the channel avatar","countParticipants":"{0} participants","countFollower":"{0} followers","info":"Info","errorImageEx":"The image does not meet the requirements. The image format should be JPG, GIF or PNG","user":"User","update":"Update","permissions":"Permissions","reader":"Reader","postMessages":"Post messages","read":"Read","canWriteMessages":"The user can write messages","adminDesc":"Administrator permissions allow the user to: <ul> <li>grant any permissions to users</li> <li>remove any users</li> <li>delete messages</li> <li>edit chat / channel information</li> <li>close chat / channel</li> </ul>","moderatorDesc":"Moderator permissions allow the user to: <ul> <li>grant users permissions lower than moderator</li> <li>remove users with lower permissions</li> <li>delete messages</li> </ul>","urlChannelDesc":"Only letters, numbers, minus and underscore are allowed. The minimum length is {0} symbols, a letter should come first","chatNotFound":'<h3>Chat not found</h3> <p><a href="{0}" onclick="{1}" class="{2}">Main chat page</a></p>',"collapse":"Collapse","showOriginal":"Show original","errorLoading":"Unable to download attachment","next":"Next","previous":"Previous","linkToImg":"Link to the image","linkToVideo":"Link to the video","search":"Search","chats":"Chats","subscribed":"Subscribed","add":"Send","message":"Message","emptyMessageError":"Message cannot be empty","longMessageError":"The message should not exceed {0} characters","invalidType":"Incorrect file type","deleteAllMessagesFromConfirm":"Do you really want to delete all messages from {0}?","complaint":"complain","abuse":"Abuse","advert":"Advertisement","spam":"Spam","complaintTitle":"Complaint","complaintOther":"Other","complaintError":"Error ocured. Try send complaint later.","complaintSuccess":"Your complaint has been successfully sent!","complaintLength":"The length must range from {0} to {1} characters.","characters":"characters","comment":"Comment","complaintContains":"Message contains","back":"Back","new":"New","my":"My","popular":"Popular","recommended":"Recommended","unsubscribeConfirmChannel":"Do you really want to leave the {0} channel?","unsubscribeConfirmGroup":"Do you really want to leave the {0} group?","chatEdit":"Edit","writer":"Author","avatarErrorSize":"The image size should be at least {0}x{1} pixels","friendWaitingPair":"You'll be able to start a chat once the user confirms your friend request","emptyChatsListShort":'<p>You have no chats.</p><p>Please use the search or create a new chat</p>',"errorUserNonChatablePrivacyFriends":"The user has enabled incoming personal messages from friends only","privacyOnlyFriendsWithName":"{0} has enabled incoming personal messages from friends only","zoomIn":"zoom in","zoomOut":"zoom out","friendWaitingPairWithName":"You'll be able to start a chat once {0} confirms your friend request","dragAndDrop":"Upload","reportSpam":"Report spam","addingMembers":"Adding members","you":"You","commentAuthor":"Comment author","notAllowedAdd":"Users {0} have disabled the ability to add them to groups and channels","replyMessage":"Reply","editMembers":"Edit members","membersCount":"Members ({0})","searchMembers":"Searching for members","errorUserNotFound":"User not found","membersList":"List of members","urlGroup":"Group URL","usefulLinks":"Useful links","copied":"Copied","type":"Type","management":"Management","closeGroup":"Close group","closeChannel":"Close channel","openGroup":"Open group","openChannel":"Open channel","maxNumberFiles":"Maximum number of attached files: {0}","noMessagesYet":"No messages here yet. Send a message to start a chat.","upload":"Upload","addUsefulLinks":"Add useful links:","nameNSymbols":"Name (up to {0} characters)","descNSymbols":"Description (up to {0} characters)","isLimitedShort":"Users are able to add members","created":"Created","deleted":"Deleted","join":"Join","leaveGroup":"Leave group","notifications":"Notifications","mute":"Mute","unmute":"Unmute","andMoreMembers":"and {0} more members","retry":"Retry","verified":"Verified","blockUser":"Block user","unblockUser":"Unblock user","errorUserBannedAnotherUser":"Cannot send message. This user has blocked you.","warningUserBlocked":"You have blocked this user. They cannot send you messages.",};var chatSettings={'mode':'prod','complaintKey':"f0eb2e30554a06a30b8e86f376505a79",'userId':"0CBDAB0100000000",'userLogin':'deszkmihaly67','language':'en','playSounds':true,'accessLevel':0,'friendlyHosts':[".gov.uk",".wikipedia.org",".zerohedge.com",".metatrader4.com",".metatrader5.com",".mql4.com",".mql5.com",".mql5.com",".mql5.dev",".metaquotes.net",".teamwox.com",".forex-tsd.com",".finteza.com",".adp.com",".bakerhughes.com",".bankofcanada.ca",".bankofengland.co.uk",".bba.org.uk",".boj.or.jp",".brc.org.uk",".cao.go.jp",".chicagofed.org",".cmhc-schl.gc.ca",".conference-board.org",".consilium.europa.eu",".customs.go.jp",".dallasfed.org",".ec.europa.eu",".ecb.europa.eu",".halifax.co.uk",".iea.org",".imf.org",".instituteforsupplymanagement.org",".ivey.uwo.ca",".kansascityfed.org",".markiteconomics.com",".meti.go.jp",".mhlw.go.jp",".mni-indicators.com",".mof.go.jp",".nahb.org",".nar.realtor",".newyorkfed.org",".niesr.ac.uk",".opec.org",".parliament.uk",".philadelphiafed.org",".rics.org",".stat.go.jp",".statcan.gc.ca",".us.spindices.com",".zew.de",".youtube.com",".lst.to",".tradays.com",".linkedin.com"],'readonly':false,'type':0,'token':'9fc8ede567806705cd720df5646c86ab3b57ea8f6933cae134857958f3dfe5b8b113ef017b93894176e63f4b978b903fabda780436e605bb9f9aed54cb5a96bf5e09bba26aa912b8ecb3486eef59ecb817b9b23315f30d4a4cc2eb128e36bb148e58711e748c89fb99a5144340436092','url':'msg1.mql5.com','servers':['msg1.mql5.com'],'version':28,'uniq':"6428434430243088515",'localization':localization,};window.initChatWidget(chatSettings);});if(!window.dateToTextLocalization)window.dateToTextLocalization={'m1':'{0} minute ago','m2':'{0} minutes ago','m3':'{0} minutes ago','h1':'{0} hour ago','h2':'{0} hours ago','h3':'{0} hours ago','lang':'en'};window.fz("show","bfogggabsofabcpxuzmgaibarmaxasdrj");window.fz("show","vgckrufggwxdtfscpyalmenexmvhljduja");							if (typeof Attach !== "undefined")
			Attach.setAcceptFilter(".zip, .txt, .log, .mqh, .ex5, .mq5, .mq4, .mqproj, .ex4, .mt5, .set, .tpl, .cl, .py, .sqlite, .csv, .ini, .ipynb, .onnx, .gif, .png, .jpg, .jpeg, .mp4, .webm");
	</script>

<script type="application/ld&#x2B;json">
		[
			{
				"@context": "https://schema.org",
				"@type": "Organization",
				"url": "https://www.mql5.com",
				"logo": "https://c.mql5.com/i/community/logo_mql5-2.png",
				"sameAs": [
					"https://www.facebook.com/mql5.community",
					"https://www.x.com/mql5com",
					"https://www.youtube.com/user/MetaQuotesOfficial"
				 ]
			}
		
, 
{"@context":"https://schema.org","@type":"ItemList","itemListElement":[{"@type":"SiteNavigationElement","position":1,"name":"Forum","description":"Discussions of trading strategies and algorithmic trading. MQL5.community  the largest forex forum","url":"https://www.mql5.com/en/forum","children":[]},{"@type":"SiteNavigationElement","position":2,"name":"Market","description":"MetaTrader Market - a Market of trading robots, indicators, trading books and magazines","url":"https://www.mql5.com/en/market","children":[]},{"@type":"SiteNavigationElement","position":3,"name":"Signals","description":"Social trading, copy trading and account monitoring with MetaTrader - Trading Signals on MQL5.com","url":"https://www.mql5.com/en/signals","children":[]},{"@type":"SiteNavigationElement","position":4,"name":"Freelance","description":"Order trading robots, technical indicators and algorithmic trading applications. Forex jobs. Freelance on MQL5.com. Hire MetaTrader experts and specialists","url":"https://www.mql5.com/en/job","children":[]},{"@type":"SiteNavigationElement","position":5,"name":"Quotes","description":"","url":"https://www.mql5.com/en/quotes/overview","children":[]},{"@type":"SiteNavigationElement","position":6,"name":"WebTerminal","description":"WebTerminal for the MetaTrader trading platform. Online forex trading.","url":"https://web.metatrader.app/terminal?mode=demo","children":[]},{"@type":"SiteNavigationElement","position":7,"name":"Calendar","description":"","url":"https://www.mql5.com/en/economic-calendar","children":[]},{"@type":"SiteNavigationElement","position":8,"name":"VPS","description":"","url":"https://www.mql5.com/en/vps","children":[]},{"@type":"SiteNavigationElement","position":9,"name":"Articles","description":"","url":"https://www.mql5.com/en/articles","children":[]},{"@type":"SiteNavigationElement","position":10,"name":"CodeBase","description":"Download trading robots, technical indicators and scripts with source code - MQL5 Code Base for MetaTrader 5","url":"https://www.mql5.com/en/code","children":[]},{"@type":"SiteNavigationElement","position":11,"name":"Algo Forge","description":"","url":"https://forge.mql5.io","children":[]},{"@type":"SiteNavigationElement","position":12,"name":"Documentation","description":"MetaQuotes Language 5 (MQL5) Reference - Documentation on MQL5.com","url":"https://www.mql5.com/en/docs","children":[]}]}		
,
{"@context":"https://schema.org","@type":"TechArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.mql5.com/en/articles/20339"},"headline":"Automating Trading Strategies in MQL5 (Part 42): Session-Based Opening Range Breakout (ORB) System","image":["https://c.mql5.com/2/181/Screenshot_2025-11-18_110512.png","https://c.mql5.com/2/181/Screenshot_2025-11-18_102142.png","https://c.mql5.com/2/181/C_MQL5_WINGDINGS__1.png","https://c.mql5.com/2/181/Screenshot_2025-11-18_110930.png","https://c.mql5.com/2/181/Screenshot_2025-11-18_113102.png","https://c.mql5.com/2/181/ORB_GIF.gif","https://c.mql5.com/2/181/Screenshot_2025-11-18_123022.png","https://c.mql5.com/2/181/Screenshot_2025-11-18_123035.png"],"datePublished":"2025-11-26T12:20:53+00:00Z","dateModified":"2025-11-26T12:26:48+00:00Z","author":{"@type":"Person","name":"Allan Munene Mutiiria","url":"https://www.mql5.com/en/users/29210372"},"publisher":{"@type":"Organization","name":"MQL5 Community","url":"https://www.mql5.com","logo":{"@type":"ImageObject","url":"https://c.mql5.com/i/community/logo_mql5-2.png"}},"description":"In this article, we create a fully customizable session-based Opening Range Breakout (ORB) system in MQL5 that lets us set any desired session start time and range duration, automatically calculates the high and low of that opening period, and trades only confirmed breakouts in the direction of the move."}
,
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":"https://www.mql5.com/en/articles","name":"Articles"},{"@type":"ListItem","position":2,"item":"https://www.mql5.com/en/articles/mt5","name":"MetaTrader 5"},{"@type":"ListItem","position":3,"item":"https://www.mql5.com/en/articles/mt5/trading","name":"Trading"}]}

		]
	</script>
</body>
</html>